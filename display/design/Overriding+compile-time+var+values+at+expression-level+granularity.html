
<!DOCTYPE html>
<html>
<head>
    <title>Overriding compile-time var values at expression-level granularity - Clojure Design - Clojure Development</title>

        

                        
    

            <meta http-equiv="X-UA-Compatible" content="IE=EDGE">
<meta charset="UTF-8">
<!-- Deprecated since 3.4. To be removed in a future version of Confluence; use AJS.Confluence.getContextPath() -->
<meta id="confluence-context-path" name="confluence-context-path" content="">
<meta id="confluence-base-url" name="confluence-base-url" content="https://dev.clojure.org">

<meta id="atlassian-token" name="atlassian-token" content="30041c830a95ce9c95d0b58cb377def6b96aa6d2">

<meta id="confluence-space-key" name="confluence-space-key" content="design">
<script type="text/javascript">
    // Deprecated global variables. To be removed in a future version of Confluence.
    var contextPath = '';
</script>

    

<!-- include system css resources -->


    <link type="text/css" rel="stylesheet" href="../../s/en_GB/3047/3/55/_/download/superbatch/css/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/en_GB/3047/3/55/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if IE 9]>
<link type="text/css" rel="stylesheet" href="/s/en_GB/3047/3/55/_/download/superbatch/css/batch.css?conditionalComment=IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/en_GB/3047/3/55/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/3047/3/55/_/download/superbatch/css/batch-media=print.css" media="print">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/en_GB/3047/3/961a0823b948d2f215d5a69c25b0d622/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/3047/3/961a0823b948d2f215d5a69c25b0d622/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/en_GB/3047/3/c80b4ecc4b1853e829650e7c54066b66/_/download/contextbatch/css/viewcontent,main/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/3047/3/c80b4ecc4b1853e829650e7c54066b66/_/download/contextbatch/css/viewcontent,main/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/3047/3/2.0.1/_/download/batch/com.atlassian.confluence.plugins.pagetree-pagetree-resources/com.atlassian.confluence.plugins.pagetree-pagetree-resources.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/3047/3/3/_/styles/colors-spaceKey=design.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/3047/3/2.0.5/_/download/resources/com.atlassian.confluence.plugins.doctheme-documentation/default-theme.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/3047/3/2.0.5/_/download/resources/com.atlassian.confluence.plugins.doctheme-documentation/splitter.css" media="all">

<!-- end system css resources -->

    <meta name="confluence-request-time" content="1556129202751">
            <meta name="ajs-page-id" content="5242904">
            <meta name="ajs-parent-page-id" content="950459">
            <meta name="ajs-space-key" content="design">
            <meta name="ajs-space-name" content="Clojure Design">
            <meta name="ajs-page-title" content="Overriding compile-time var values at expression-level granularity">
            <meta name="ajs-parent-page-title" content="Core">
            <meta name="ajs-from-page-title" content="">
            <meta name="ajs-context-path" content="">
            <meta name="ajs-version-number" content="4.0">
            <meta name="ajs-build-number" content="3047">
            <meta name="ajs-remote-user" content="">
            <meta name="ajs-static-resource-url-prefix" content="/s/en_GB/3047/3/_">
            <meta name="ajs-global-settings-attachment-max-size" content="10485760">
            <meta name="ajs-user-locale" content="en_GB">
            <meta name="ajs-enabled-dark-features" content="">
            <meta name="ajs-atl-token" content="30041c830a95ce9c95d0b58cb377def6b96aa6d2">
            
            <meta name="ajs-keyboardshortcut-hash" content="7b95af54c6deada096af1f28fdd0f413">
            <meta name="ajs-use-keyboard-shortcuts" content="true">
    <!-- Deprecated since 3.4. To be removed in a future version of Confluence; use atl.header -->
        
            <script type="text/x-template" title="share-content-popup">
    <form action="#" method="post" class="aui share-content-popup">
        <fieldset>
            <label for="users">User name or email</label>
            <div class="autocomplete-user-target">
                <input class="text autocomplete-sharepage" id="users" data-max="10" data-dropdown-target=".autocomplete-user-target" data-none-message="No matching user or email found"/>
            </div>
            <ol class="recipients">
            </ol>
            <div><label for="note">Note</label></div>
            <textarea class="textarea" id="note" placeholder="Add an optional note"/>
        </fieldset>
        <div class="button-panel">
            <div class="progress-messages-icon"></div>
            <div class="progress-messages">
            </div>
            <input class="button submit" type="submit" value="Share" disabled/>
            <a class="close-dialog" href="#">Cancel</a>
        </div>
    </form>
</script>

<script type="text/x-template" title="share-content-popup-recipient-username">
    <li data-username="{username}" style="display: none">
        <span>
            <img src="{thumbnailLink.href}" title="{title}">
            <span>{title}</span>
            <span class="remove-recipient"/>
        </span>
    </li>
</script>

<script type="text/x-template" title="share-content-popup-recipient-email">
    <li data-email="{email}" style="display: none">
        <span>
            <img src="{icon}" title="{email}">
            <span>{email}</span>
            <span class="remove-recipient"/>
        </span>
    </li>
</script>
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="icon" type="image/png" href="../../s/en_GB/3047/3/_/images/logo/confluence_16.png">

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch/osd.action.xml" title="Clojure Development"/>

        <!-- include system javascript resources -->
                        
    
    <script type="text/javascript" src="../../s/en_GB/3047/3/55/_/download/superbatch/js/batch.js" ></script>
<!--[if lte IE 8]>
<script type="text/javascript" src="/s/en_GB/3047/3/55/_/download/superbatch/js/batch.js?conditionalComment=lte+IE+8" ></script>
<![endif]-->
<script type="text/javascript" src="../../s/en_GB/3047/3/961a0823b948d2f215d5a69c25b0d622/_/download/contextbatch/js/page/batch.js" ></script>
<script type="text/javascript" src="../../s/en_GB/3047/3/c80b4ecc4b1853e829650e7c54066b66/_/download/contextbatch/js/viewcontent,main/batch.js" ></script>
<script type="text/javascript" src="../../s/en_GB/3047/3/2.0.1/_/download/batch/com.atlassian.confluence.plugins.pagetree-pagetree-resources/com.atlassian.confluence.plugins.pagetree-pagetree-resources.js" ></script>

    
    <!-- end system javascript resources -->

    

    
    <link rel="canonical" href="Overriding+compile-time+var+values+at+expression-level+granularity.html">
    <link rel="shortlink" href="Overriding+compile-time+var+values+at+expression-level+granularity.html">
    <meta name="wikilink" content="[design:Overriding compile-time var values at expression-level granularity]">
    <meta name="page-version" content="14">

</head>

<body             onload="placeFocus()"
     id="com-atlassian-confluence" class="theme-documentation ">
<div id="full-height-container">
    <div id="header-precursor">
        
        
                </div>

<div id="header" class="sectionbottom ">
        <form id="quick-search" class="quick-search" method="get" action="../../dosearchsite.action.html">
                <fieldset>
            <input type="hidden" name="spaceSearch" value="false"/>
        </fieldset>
        <fieldset>
            <legend>Quick Search</legend>
            <input class="quick-search-query" id="quick-search-query" type="text" accessKey="search-pages-action.accesskey" autocomplete="off" name="queryString" size="25"/>
            <input class="quick-search-submit" id="quick-search-submit" type="submit"  value="Search Confluence" />
            <div class="aui-dd-parent quick-nav-drop-down"><!-- Quick nav appears here --></div>
        </fieldset>
        <fieldset class="hidden parameters">
            <input type="hidden" id="quickNavEnabled" value="true" />
                    </fieldset>
    </form>

    <ul id="header-menu-bar" class="ajs-menu-bar">
                    
        
            <li class="normal ajs-menu-item">
        <a id="browse-menu-link" class="browse trigger ajs-menu-title" href="#"><span><span>Browse</span></span></a>         <div class="assistive ajs-drop-down">
                        <ul  id="browse-menu-link-leading"                 class="section-leading first">
                                        <li>
    
        
    
    <a  id="space-pages-link" href="../../pages/recentlyupdated.action-key=design.html"  class=""   title="Browse pages in the Clojure Design space">
                   <span>Pages</span></a>        </li>
                                        <li>
    
        
    
    <a  id="space-blogposts-link" href="../../pages/viewrecentblogposts.action-key=design.html"  class=""   title="Browse blogs in the Clojure Design space">
                   <span>Blog</span></a>        </li>
                                        <li>
    
        
    
    <a  id="space-labels-link" href="../../labels/listlabels-heatmap.action-key=design.html"  class=""   title="Browse labels in the Clojure Design space">
                   <span>Labels</span></a>        </li>
                                        <li>
    
        
    
    <a  id="space-attachments-link" href="../../spaces/listattachmentsforspace.action-key=design.html"  class=""   title="Browse attachments in the Clojure Design space">
                   <span>Attachments</span></a>        </li>
                                        <li>
    
        
    
    <a  id="space-mail-link" href="../../spaces/viewmailarchive.action-key=design.html"  class=""   title="Browse mail in the Clojure Design space">
                   <span>Mail</span></a>        </li>
                                        <li>
    
        
    
    <a  id="space-advanced-link" href="../../spaces/viewspacesummary.action-key=design.html"  class=""   title="Browse additional space functions in the Clojure Design space">
                   <span>Advanced</span></a>        </li>
                            </ul>
                        <ul  id="browse-menu-link-global"                 class="section-global">
                                        <li>
    
        
    
    <a  id="whats-new-menu-link" href="http://docs.atlassian.com/confluence/docs-40/whatsnew/iframe"  class=""   title="">
                   <span>What’s New</span></a>        </li>
                                        <li>
    
        
    
    <a  id="space-directory-link" href="../../spacedirectory/view.action.html"  class=""   title="Browse the Confluence space directory">
                   <span>Space Directory</span></a>        </li>
                                        <li>
    
        
    
    <a  id="feed-builder-link" href="../../dashboard/configurerssfeed.action.html"  class=""   title="Create your custom RSS feed.">
                   <span>Feed Builder</span></a>        </li>
                                        <li>
    
            
    
    <a  id="keyboard-shortcuts-link" href="#"  class=""   title="View available keyboard shortcuts">
                   <span>Keyboard Shortcuts</span></a>        </li>
                                        <li>
    
            
    
    <a  id="gadget-directory-link" href="#"  class="user-item administration-link"   title="Browse gadgets provided by Confluence">
                   <span>Confluence Gadgets</span></a>        </li>
                            </ul>
                    </div>
    </li>
        
                                                         <li class="ajs-menu-item normal">
        
        
    
    <a  id="login-link" href="https://dev.clojure.org/login.action?os_destination=%2Fdisplay%2Fdesign%2FOverriding%2Bcompile-time%2Bvar%2Bvalues%2Bat%2Bexpression-level%2Bgranularity"  class="user-item login-link"   title="">
                   <span>Log In</span></a>        </li>
                            <li class="ajs-menu-item normal">
    
        
    
    <a  id="signup-link" href="../../signup.action.html"  class="user-item signup-link"   title="">
                   <span>Sign Up</span></a>        </li>
                                <li class="normal ajs-menu-item">
            <div id="splitter-button" class="hidden" title="Show or hide sidebar"></div>
        </li>

    </ul>
    
    
    <ol id="breadcrumbs">
                    
                        
        <li class="first" >
                                    <span><a href="../../dashboard.action.html" title="Go to Dashboard">Dashboard</a></span>
                </li>
                    
                
        <li>
                                    <span><a href="Home-jsessionid=3A56E29DA520B75101350BA4484B9990.html">Clojure Design</a></span>
                </li>
                                        <li id="ellipsis" title="Show all breadcrumbs"><span><strong>&#8230;</strong></span></li>
                                    
                
        <li class="hidden-crumb" >
                                    <span><a href="Home.html">Home</a></span>
                </li>
                                
                
        <li class="hidden-crumb" >
                                    <span><a href="Idea+Hammock.html">Idea Hammock</a></span>
                </li>
                                
                
        <li class="hidden-crumb" >
                                    <span><a href="Core.html">Core</a></span>
                </li>
                    
                
        <li>
                                    <span><a href="Overriding+compile-time+var+values+at+expression-level+granularity.html">Overriding compile-time var values at expression-level granularity</a></span>
                </li>
        </ol>

</div>

    <div id="splitter">
    <div id="splitter-sidebar" >
        

                    
        
    

<div class="plugin_pagetree">

                <div id="pagetreesearch">
            <form method="POST" action="../../dosearchsite.action-searchQuery.queryString=&amp;searchQuery.spaceKey=conf_all.html" name="pagetreesearchform">
                                    <input type="hidden" name="ancestorId" value="458775">
                                <input type="hidden" name="spaceKey" value="design">
                <input type="text"  size="20" name="queryString">
                <input type="submit" value="Search">
            </form>
        </div>
    
        
    <ul class="plugin_pagetree_children_list plugin_pagetree_children_list_noleftspace">
        <div class="plugin_pagetree_children">
        </div>
    </ul>

    <fieldset class="hidden">
        <input type="hidden" name="treeId" value="">
        <input type="hidden" name="treeRequestId" value="/plugins/pagetree/naturalchildren.action?decorator=none&amp;excerpt=false&amp;sort=position&amp;reverse=false&amp;disableLinks=false">
        <input type="hidden" name="treePageId" value="5242904">

        <input type="hidden" name="noRoot" value="false">
        <input type="hidden" name="rootPageId" value="458775">

        <input type="hidden" name="rootPage" value="">
        <input type="hidden" name="startDepth" value="0">
        <input type="hidden" name="spaceKey" value="design" >

        <input type="hidden" name="i18n-pagetree.loading" value="Loading...">
        <input type="hidden" name="i18n-pagetree.error.permission" value="Unable to load page tree. It seems that you do not have permission to view the root page.">
        <input type="hidden" name="i18n-pagetree.eeror.general" value="There was a problem retrieving the page tree. Please check the server log file for more information.">
        <input type="hidden" name="loginUrl" value="/login.action?os_destination=%2Fdisplay%2Fdesign%2FOverriding%2Bcompile-time%2Bvar%2Bvalues%2Bat%2Bexpression-level%2Bgranularity">

                <fieldset class="hidden">
                                                <input type="hidden" name="ancestorId" value="950459">
                                    <input type="hidden" name="ancestorId" value="8192213">
                                    <input type="hidden" name="ancestorId" value="458775">
                                    </fieldset>
    </fieldset>
</div>



            </div>
    <div id="splitter-content">

                    <script type="text/javascript" src="../../s/en_GB/3047/3/2.0.5/_/download/resources/com.atlassian.confluence.plugins.doctheme-resources/doc-theme.js"></script>
    
            
    
<div id="main" >
    <div id="main-header">
	    
	    
    <div id="navigation" class="content-navigation view">
                    <ul class="ajs-menu-bar">
                                
                        
            <li class="normal ajs-menu-item">
        <a id="action-menu-link" class="action trigger ajs-menu-title" href="#"><span><span>Tools</span></span></a>         <div class="assistive ajs-drop-down">
                        <ul  id="action-menu-link-primary"                 class="section-primary first">
                                        <li>
    
        
    
    <a  id="view-attachments-link" href="../../pages/viewpageattachments.action-pageId=5242904.html"  class="action-view-attachments"  accessKey="a"  title="View Attachments">
                   <span><u>A</u>ttachments (2)</span></a>        </li>
                                        <li>
    
        
    
    <a  id="action-view-history-link" href="../../pages/viewpreviousversions.action-pageId=5242904.html"  class="action-view-history"   title="">
                   <span>Page History</span></a>        </li>
                                        <li>
    
        
    
    <a  id="action-page-permissions-link" href="../../pages/viewinfo.action-pageId=5242904.html"  class="action-page-permissions"   title="Edit restrictions">
                   <span>Restrictions</span></a>        </li>
                            </ul>
                        <ul  id="action-menu-link-secondary"                 class="section-secondary">
                                        <li>
    
        
    
    <a  id="view-page-info-link" href="../../pages/viewinfo.action-pageId=5242904.html"  class="action-view-info"   title="">
                   <span>Info</span></a>        </li>
                                        <li>
    
        
    
    <a  id="link-to-page-link" href="../../pages/viewinfo.action-pageId=5242904.html"  class=""   title="Link to this Page">
                   <span>Link to this Page&hellip;</span></a>        </li>
                                        <li>
    
        
    
    <a  id="view-in-hierarchy-link" href="../../pages/listpages-dirview.action-key=design&amp;openId=5242904.html#selectedPageInHierarchy"  class=""   title="">
                   <span>View in Hierarchy</span></a>        </li>
                                        <li>
    
        
    
    <a  id="action-view-source-link" href="../../plugins/viewsource/viewpagesrc.action-pageId=5242904.html"  class="action-view-source popup-link"   title="">
                   <span>View Source</span></a>        </li>
                            </ul>
                    </div>
    </li>
            </ul>
    </div>

	    
	    <h1 id="title-heading" class="pagetitle">
	        	            <a href="Home-jsessionid=3A56E29DA520B75101350BA4484B9990.html"><img class="logo global custom" src="../../download/attachments/131074/global.logo.png" alt=""></a>	        	
			<span id="title-text">
							            <a href="Overriding+compile-time+var+values+at+expression-level+granularity.html">Overriding compile-time var values at expression-level granularity</a>
    						</span>
	    </h1>
	</div>

    

    
    
    
    
    

                                                                                                                                                                                                                                                                                                                                                                                                                                                                      




        













    
    
        
    
    
                    
    

    


<div id="content" class="page view">
    



                
<script type="text/x-template" title="movePageDialog">
    <div class="row information">
        <div class="inner">
            <div class="element">
                Specify the new parent page for this page and its children by space and title.
            </div>
        </div>
    </div>
    <div class="form">
        <fieldset>
                

    <legend class="assistive"><span>Change the Parent Page to a Known Page</span></legend>
            <div class="row">
                <label for="new-space">New space:</label>
                <div class="value new-space-value">
                    <input id="new-space-key" name="new-space-key" type="hidden" value="design">
                                            <span class="space-input">
                            <input id="new-space" name="new-space" value="Clojure Design" disabled="disabled">
                        </span>
                        <span class="description warning">You cannot move this page to another space because you do not have permission to remove it from this space.</span>
                                        <div class="new-space-dropdown aui-dd-parent autocomplete"></div>
                </div>
            </div>
            <div class="row">
                <label for="new-parent-page">New parent page:</label>
                <div class="value new-parent-page-value">
                    <span class="page-input">
                        <input id="new-parent-page" name="new-parent-page" value="Core">
                    </span>
                    <span class="description">Start typing a page title to see a list of suggestions.</span>
                    <div class="new-parent-page-dropdown aui-dd-parent autocomplete"></div>
                </div>
            </div>
        </fieldset>
    </div>
    <div class="location-info">
        <div class="row">
            <label>Current location:</label>
            <div class="value breadcrumbs-container">
                <div class="breadcrumbs-line">
                    <ul id="current-parent-breadcrumbs" class="breadcrumbs">
                    </ul>
                </div>
            </div>
        </div>
        <div class="row">
            <label>New location:</label>
            <div class="value breadcrumbs-container">
                <div class="breadcrumbs-line">
                    <ul id="new-parent-breadcrumbs" class="breadcrumbs">
                    </ul>
                </div>
            </div>
        </div>
    </div>
</script>

<script type="text/x-template" title="movePageSearchPanel">
    <div class="row information">
        <div class="inner">
            <div class="element">
                Search for and select the new parent page for this page and its children.
            </div>
        </div>
    </div>
    <div id="move-page-search-container" class="row">
        <div class="search-form">
            <fieldset>
                    

    <legend class="assistive"><span>Search for a New Parent Page</span></legend>
                    

    <label  for="move-page-search-query" class="assistive">Search keywords</label>
                <input class="search-query" id="move-page-search-query">
                    

    <label  for="move-page-search-space" class="assistive">Search in space</label>
                                    <select id="move-page-search-space" class="search-space" disabled="disabled">
                        <option value="design" selected="selected">Clojure Design</option>
                    </select>
                                <input type="button" value="Search">
                                    <div class="description warning">You cannot move this page to another space because you do not have permission to remove it from this space.</div>
                            </fieldset>
        </div>
        <div class="search-results">
        </div>
    </div>
</script>
<script type="text/x-template" title="searchResultsGrid">
    <table>
        <thead>
            <tr class="header">
                <th class="search-result-title">Page Title</th>
                <th class="search-result-space">Space</th>
                <th class="search-result-date">Updated</th>
            </tr>
        </thead>
    </table>
</script>
<script type="text/x-template" title="searchResultsGridCount">
    <p class="search-result-count">{0}</p>
</script>
<script type="text/x-template" title="searchResultsGridRow">
    <tr class="search-result">
        <th class="search-result-title"><a href="{1}" class="content-type-{2}"><span>{0}</span></a></th>
        <td class="search-result-space"><a class="space" href="/display/{4}/" title="{3}">{3}</a></td>
        <td class="search-result-date"><span class="date" title="{6}">{5}</span></td>
    </tr>
</script><!-- Start restrictions section -->
<script type="text/x-template" title="page-permissions-div">
<div id="page-permissions-div">
    <div id="page-permissions-editor-form">

                <div id="page-permissions-error-div" class="hidden">
            <a href="#" id="permissions-error-div-close">Ok</a>
            <div></div>
        </div>

                <div id="page-permissions-type-radios" class="page-permissions-label-rows">
            <div>
                <input id="restrictViewRadio" type="radio" checked="checked" name="pagePermissionTypeRadio" value="view"/>
                <label for="restrictViewRadio">Restrict viewing of this page</label>
                <input id="restrictEditRadio" type="radio" name="pagePermissionTypeRadio" value="edit"/>
                <label for="restrictEditRadio">Restrict editing of this page</label>
            </div>
        </div>
        <div id="page-permissions-input" class="page-permissions-label-rows">
            <div class="page-permissions-label">To:</div>
            <div id="page-permissions-chooser-box">
                                <span id="page-permissions-choose-user" class="ajs-button">
                    



    



<a href="#" id='userpicker-popup-link-image' onClick="var picker = window.open('/spaces/openuserpicker.action?key=design&amp;startIndex=0&amp;onPopupSubmit=AJS.PagePermissions.addUserPermissions', 'EntitiesPicker', 'status=yes,resizable=yes,top=100,left=200,width=700,height=680,scrollbars=yes'); picker.focus(); return false;"><img src="/s/en_GB/3047/3/_/images/icons/user_16.gif" height=16 width=16 border=0 align="absmiddle"  title="Choose users" /></a>
<a href="#" id='userpicker-popup-link-text' onClick="var picker = window.open('/spaces/openuserpicker.action?key=design&amp;startIndex=0&amp;onPopupSubmit=AJS.PagePermissions.addUserPermissions', 'EntitiesPicker', 'status=yes,resizable=yes,top=100,left=200,width=700,height=680,scrollbars=yes'); picker.focus(); return false;">Person...</a>


                </span>
                <span id="page-permissions-choose-group" class="ajs-button">
                    



    

 

<a href="#" id='grouppicker-popup-link-image' onClick="var picker = window.open('/spaces/opengrouppicker.action?key=design&amp;startIndex=0&amp;actionName=dosearchgroups.action&amp;onPopupSubmit=AJS.PagePermissions.addGroupPermissions', 'EntitiesPicker', 'status=yes,resizable=yes,top=100,left=200,width=580,height=550,scrollbars=yes'); picker.focus(); return false;"><img src="/s/en_GB/3047/3/_/images/icons/group_16.gif" height=16 width=16 border=0 align="absmiddle"  title="Choose groups" /></a>
<a href="#" id='grouppicker-popup-link-text' onClick="var picker = window.open('/spaces/opengrouppicker.action?key=design&amp;startIndex=0&amp;actionName=dosearchgroups.action&amp;onPopupSubmit=AJS.PagePermissions.addGroupPermissions', 'EntitiesPicker', 'status=yes,resizable=yes,top=100,left=200,width=580,height=550,scrollbars=yes'); picker.focus(); return false;">Group...</a>


                </span>
            </div>
            <div id="page-permissions-input-box">
                <input type="text" id="page-permissions-names-input" name="permissionNames"
                    placeholder="Enter user or group name" class="autocomplete-user"
                    data-max="10" data-none-message="No matches"
                    data-target="#page-permissions-names-hidden" data-template="{username}"
                    data-dropdown-target="#page-perms-name-dropdown-wrapper" data-resize-to-input="true"
                    size="30"/>
                <input
    type="hidden"
                            id="page-permissions-names-hidden"           />                <img height="16px" width="1px" src="/s/en_GB/3047/3/_/images/border/spacer.gif"/>
                <input type="button" id="add-typed-names" value="Restrict">
                <div id="page-perms-name-dropdown-wrapper" class="aui-dd-parent autocomplete"></div>
            </div>
        </div>
    </div>
    <div id="page-permissions-tables">
        <div id="page-permissions-table-div">
                        <table id="page-permissions-table" class="page-permissions-table">
                <tr id="page-permissions-no-views" class="marker-row">
                    <td colspan="3" class="page-permissions-marker-cell"><span>No view restrictions are defined for this page</span></td>
                </tr>
                <tr id="page-permissions-no-edits" class="marker-row">
                    <td colspan="3" class="page-permissions-marker-cell"><span>No edit restrictions are defined for this page</span></td>
                </tr>
            </table>
        </div>
        <div id="page-inherited-permissions-table-div" class="hidden">
            <span id="page-inherited-permissions-table-desc">
                <a class="icon twisty-closed">Show/Hide</a>
                <a id="toggle-inherited-permissions" title="Click to see inherited restrictions">This page has restricted parent pages. It can only be seen by users who can see those parent pages.</a>
            </span>
            <div id="page-inherited-permissions-tables" class="hidden page-inheritance-togglable"></div>
        </div>
    </div>
</div>
</script>

<!-- End restrictions section -->

        
    
    
        <fieldset class="hidden parameters">
            <input type="hidden" title="parentPageId" value="950459">
        </fieldset>

        
                            
    

                    

        
        <a href="#page-metadata-end" class="assistive">Skip to end of metadata</a>
<div id="page-metadata-start" class="assistive"></div>

    <div class="page-metadata">
        <ul>
                            <li class="page-metadata-item noprint">
    
            
    
    <a  id="content-metadata-page-restrictions" href="#"  class="page-metadata-icon page-restrictions hidden"   title="Page restrictions apply. Click the lock icon to view or edit the restriction.">
                   <span>Page restrictions apply</span></a>        </li>
                            <li class="page-metadata-item noprint">
    
        
    
    <a  id="content-metadata-attachments" href="../../pages/viewpageattachments.action-pageId=5242904&amp;metadataLink=true.html"  class="page-metadata-icon action-view-attachments"  accessKey="a"  title="Attachments: 2">
                   <span><span class="page-metadata-attachments-text">Attachments:</span><span class="page-metadata-attachments-count">2</span></span></a>        </li>
                        <li class="page-metadata-modification-info">
                                    Added by <a href="../../login.action-os_destination=-display-~andy.fingerhut.html"
                          class="url fn"
                   >Andy Fingerhut</a>, last edited by <a href="../../login.action-os_destination=-display-~jafingerhut.html"
                          class="url fn"
                   >Andy Fingerhut</a> on Apr 11, 2013
                                                                <span class="noprint">&nbsp;(<a id="view-change-link" href="../../pages/diffpages.action-pageId=5242904&amp;originalId=7700496.html">view change</a>)</span>
                                                </li>
                    </ul>
                </div>


<a href="#page-metadata-start" class="assistive">Go to start of metadata</a>
<div id="page-metadata-end" class="assistive"></div>
        
        <fieldset class="hidden parameters">
                        <input type="hidden" title="browsePageTreeMode" value="view">
        </fieldset>

        <div class="wiki-content">
                           <h1 id="Overridingcompile-timevarvaluesatexpression-levelgranularity-ProblemStatement">Problem Statement</h1><p>It is easy to change the values of compile-time vars like *warn-on-reflection* and *unchecked-math* from a particular point in a file until the end of the file with set!.  You can also change the value of one of these vars for one top-level form by setting it to a desired value before the top-level form, and then setting its value back to the original after that top-level form.</p><p>However, there are cases where it would be desirable to change the value of such a var for an individual expression.</p><ol><li>For example, you may want *unchecked-math* to be true for part of a function's definition, either a few individual subexpressions, or a larger part of it.</li><li>Another is that you want *warn-on-reflection* to be true for most of your library, but there are a few instances of reflection that you are aware of and either they cannot be eliminated, or they are rare enough in practice that they are not a performance problem.  You want to mark the expressions using reflection so that they do not cause a compile-time warning, but you want such warnings enabled everywhere else in that same function in case future changes introduce a new use of reflection.</li></ol><p>Future plan that I consider the biggest bang-for-the-buck for this idea: In Clojure core and all modular contrib libraries, make it the default to build with reflection warnings enabled.  After type-hinting the ones away that can be easily and safely done so, wrap the rest of the expressions causing the warnings in (known-reflection ...) so they no longer cause warnings, but are clearly marked in the source code as causing reflection.  From that point forward, every time a developer adds code that causes a new reflection warning, they will find out on the very next build attempt, and it will likely get fixed or marked with (known-reflection ...) quite soon afterwards.  Such changes in Clojure core and contrib would be done in separate commits after this change was in.</p><h1 id="Overridingcompile-timevarvaluesatexpression-levelgranularity-ProposalAnewspecialformcompile-time-let">Proposal A: new special form compile-time-let</h1><p>This is likely the less desirable way to do it.  You can skip it and read Proposal B if you want to get to the good stuff.</p><p>Introduce a new special form in Clojure called compile-time-let that takes a vector of bindings, and makes those bindings active in the textual scope of the compile-time-let expression during compile time.  For example:</p><pre>;; I know it is easy to eliminate reflection in this simple example.<br />;; Imagine a case where it was impossible or undesirable to eliminate reflection.<br /><br />(defn recip [x]<br />  (if (ratio? x)<br />    (compile-time-let [*warn-on-reflection* false]<br />      (/ (.denominator x) (.numerator x)))<br />    (/ 1 x)))<br /><br /></pre><p>The following macro known-reflection could also be added to shorten disabling *warn-on-reflection*, if that became a common case:</p><pre>(defmacro known-reflection [&amp; body]<br />  `(compile-time-let [~'*warn-on-reflection* false]<br />     ~@body))<br /><br /></pre><p>With such a macro the definition of recip above could be rewritten:</p><pre>(defn recip [x]<br />  (if (ratio? x)<br />    (known-reflection (/ (.denominator x) (.numerator x)))<br />    (/ 1 x)))<br /><br /></pre><p>A proof-of-concept implementation of compile-time-let for Clojure on the JVM has been added as an attachment <a href="../../download/attachments/5242904/patch1.txt">patch1.txt</a> to this page.  Select &quot;Attachments&quot; under the Tools menu near the top right of the page to see it.</p><p>If you want to change *warn-on-reflection* or *unchecked-math* for an entire file, the current method of adding a line like (set! *warn-on-reflection* true) near the top of the file continues to work, and is the recommended method to do so.</p><h1 id="Overridingcompile-timevarvaluesatexpression-levelgranularity-ProposalBmetadataannotationoncode">Proposal B: metadata annotation on code</h1><p>This suggested syntax is from Aaron Cohen:</p><pre>(defn recip [x]<br />  (if (ratio? x)<br />    ^{:warn-on-reflection false} (/ (.denominator x) (.numerator x))<br />    (/ 1 x)))</pre><pre>^:warn-on-reflection ^:unchecked-math (+ 1 2)<br /><br /></pre><p>The macro known-reflection from proposal A above can be implemented as follows with this idea.  There may be shorter ways, too, but this one is tested to work.</p><pre>(defmacro known-reflection [&amp; body]<br />  `(do<br />    ^{:warn-on-reflection false}<br />    (do ~@body)))<br /><br /></pre><p>In case you are curious, this implementation of known-reflection does not work:</p><pre>(defmacro known-reflection [&amp; body]<br />  ^{:warn-on-reflection false}<br />  `(do ~@body))<br /><br /></pre><p>Earlier I believed that for my patch <a href="../../download/attachments/5242904/metadata-patch1.txt">metadata-patch1.txt</a> to work, it would require first applying a patch to fix CLJ-865 (select &quot;Attachments&quot; under the Tools menu near the top right of this page to find metadata-patch1.txt).  Further testing has shown that my patch seems to work even without fixing CLJ-865.  I think fixing CLJ-865 is a good idea anyway, but it isn't a prerequisite for this feature as implemented by the current patch.</p><p>If you want to change *warn-on-reflection* or *unchecked-math* for an entire file, the current method of adding a line like (set! *warn-on-reflection* true) near the top of the file continues to work, and is the recommended method to do so.</p><h1 id="Overridingcompile-timevarvaluesatexpression-levelgranularity-Tradeoffs">Tradeoffs</h1><p>Proposal B is better in several ways: it takes advantage of metadata annotating Clojure code that already exists in the compiler, and extends its use a little bit.  It creates no new special forms.  Source code with the new metadata annotations would compile without errors using older versions of Clojure, although the older Clojure compiler would silently give unintended compile-time behavior.</p><p>With Proposal A, new code that used the compile-time-let special form would not compile with older versions of Clojure, unless augmented with a definition of compile-time-let that would not give the desired behavior, but would simply be a &quot;no op&quot; that allows the code to compile.</p><h1 id="Overridingcompile-timevarvaluesatexpression-levelgranularity-Openquestions">Open questions</h1><p>Note: The following open questions could be addressed by a later patch.  The existing patches that are restricted to modifying *unchecked-math* and *warn-on-reflection* are useful without the enhancement below.</p><p>Question: Should expression-level modification of *compiler-options* also be allowed, e.g. by implementing the proper behavior for keywords :elide-meta and :disable-locals-clearing?</p><p>If so, should it be done with a key :compiler-options whose value is a map, like this?</p><pre>^{:warn-on-reflection false :compiler-options {:elide-meta [:doc :inline] :disable-locals-clearing true}}<br />( ... Clojure code here ... )<br /><br /></pre><p>Or would it be preferable to do it with no :compiler-options keyword at all, like this?</p><pre>^{:warn-on-reflection false :elide-meta [:doc :inline] :disable-locals-clearing true}<br />( .... Clojure code here ... )<br /><br /></pre><p>Regardless of the choice above, I believe the proper behavior would be to pushThreadBindings() a new value of the var *compiler-options* whenever metadata like the above is seen, and the new value of *compiler-options* should be the result of merging its current value with the new key/value pairs.  For example, if *compiler-options* was currently equal to {:elide-meta [:doc]}, then within the following expression:</p><pre>^{:disable-locals-clearing true}<br />( ... Clojure code here ... )<br /><br /></pre><p>the value of *compiler-options* would be {:elide-meta [:doc] :disable-locals-clearing true}.</p><h1 id="Overridingcompile-timevarvaluesatexpression-levelgranularity-Background">Background</h1><p>Discussions on the clojure-dev group:</p><div class="lf secttl"><span> Thread with subject &quot;Proposal for *warn-on-reflection* to be true by default&quot; begun on Feb 25, 2012: </span></div><p><a href="http://groups.google.com/group/clojure-dev/browse_frm/thread/5053bcb07ab33261" class="external-link" rel="nofollow">http://groups.google.com/group/clojure-dev/browse_frm/thread/5053bcb07ab33261</a></p><p>Thread with subject &quot;<span>Arbitrary subexpressions with custom compiler flags</span>&quot; begun on Mar 20, 2012:</p><p><a href="http://groups.google.com/group/clojure-dev/browse_frm/thread/d14692f8c825d27f" class="external-link" rel="nofollow">http://groups.google.com/group/clojure-dev/browse_frm/thread/d14692f8c825d27f</a></p>
    
        </div>

        <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="https://dev.clojure.org/display/design/Overriding+compile-time+var+values+at+expression-level+granularity"
    dc:identifier="https://dev.clojure.org/display/design/Overriding+compile-time+var+values+at+expression-level+granularity"
    dc:title="Overriding compile-time var values at expression-level granularity"
    trackback:ping="https://dev.clojure.org/rpc/trackback/5242904"/>
</rdf:RDF>
-->

        <script type="text/x-template" title="labels-dialog-div">

    
    <div id="labels-dialog">
        <div class="labels-editor">
            <span class="errorMessage error" id="errorSpan"></span>
            <form method="GET" action="" id="add-labels-form">
                <div id="labelOperationErrorContainer">
                    <span class="error"><span class="errorMessage" id="labelOperationErrorMessage"></span></span>
                </div>
    
                <div class="caption">Enter labels to add to this page:</div>
                <div id="label-input-fields">
                    <input autocomplete="off" id="labelsString" name="labelsString" value="">
                    <input id="add-labels-editor-button" type="submit" class="add-labels" value="Add">
                </div>
                <div id="labelsAutocompleteList" class="aui-dd-parent resize-to-input" style="width: 417px"></div>
                <div id="dialog-label-list">
                    <span id="labels-section-title-none" class="no-labels-message" >
None
</span>
<ul class="label-list">
</ul>
                </div>
                <div id="waitImageAndStatus">
                    <img class="waiting" alt="Please wait" src="/s/en_GB/3047/3/_/images/icons/wait.gif">&nbsp;
                    <span id="labelOperationStatus" class="smalltext"></span>
                </div>
                <div class="labels-tip"></div>
            </form>
        </div>
    </div>
</script>
            
    


<div id="labels-section" class="pageSection group">
    <div class="labels-editor">
        <span id="labels-section-title" class="label-title">Labels:</span>
        <div id="labels-section-content" class="content-column">
            <span id="labels-section-title-none" class="no-labels-message" >
None
</span>
<ul class="label-list">
</ul>

                            <a id="labels-edit" href="#" class="show-labels-editor editor-icon" title="Edit Labels">
                    <span class="icon icon-edit">Edit Labels</span>
                </a>
                    </div>
    </div>
</div>

            
            




            
    







<div id="comments-section" class="pageSection group">
    
            <div class="section-header ">
            <h2 id="comments-section-title" class="section-title">
                <a href="#" class="comments-show-hide comments-showing" name="comments">
                                            14 Comments
                                    </a>
            </h2>
            <a title="Hide/Show Comments" href="#" 
               class="comments-show-hide icon comments-showing icon-section-opened">
                Hide/Show Comments
            </a>
        </div>
    
    
                            <ol class="comment-threads top-level " id="page-comments">
                        <li id="comment-thread-5242907" class="comment-thread">
                                <div class="comment  " id="comment-5242907">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: brandon@brandonbloom.name" title="brandon@brandonbloom.name">                </p>
                <p class="date" title="May 28, 2012 13:41">
                    May 28, 2012
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~brandon@brandonbloom.name.html"
                          class="url fn"
                   >Brandon Bloom</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>It seems like avoiding additional special forms is a good idea, especially considering all the work going on with alterate implementations. Why do you propose a new special form over the metadata proposal?</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5242907.html#comment-5242907"
                id="comment-permalink-5242907"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5242907.html#comment-5242907"
    dc:identifier="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5242907.html#comment-5242907"
    dc:title="Overriding compile-time var values at expression-level granularity"
    trackback:ping="https://dev.clojure.org/rpc/trackback/5242907"/>
</rdf:RDF>
-->

                    
                                </li>
                        <li id="comment-thread-5242908" class="comment-thread">
                                <div class="comment  " id="comment-5242908">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: andy.fingerhut" title="andy.fingerhut">                </p>
                <p class="date" title="May 28, 2012 15:31">
                    May 28, 2012
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~andy.fingerhut.html"
                          class="url fn"
                   >Andy Fingerhut</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>This may be exactly the wrong answer, but for one, I was able to figure out how to implement it relatively quickly.  Comments in the thread proposing metadata for this purpose, especially Stuart Sierra's statement &quot;This would be a pretty substantial change to the current compiler, I think&quot; make me wonder whether anyone will exert the effort required to make it happen.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5242908.html#comment-5242908"
                id="comment-permalink-5242908"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5242908.html#comment-5242908"
    dc:identifier="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5242908.html#comment-5242908"
    dc:title="Overriding compile-time var values at expression-level granularity"
    trackback:ping="https://dev.clojure.org/rpc/trackback/5242908"/>
</rdf:RDF>
-->

                    
                                    <ol class="comment-threads">
                                        <li id="comment-thread-5242949" class="comment-thread">
                                <div class="comment  " id="comment-5242949">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: andy.fingerhut" title="andy.fingerhut">                </p>
                <p class="date" title="Jun 06, 2012 18:23">
                    Jun 06, 2012
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~andy.fingerhut.html"
                          class="url fn"
                   >Andy Fingerhut</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>Since my earlier reply to Brandon's question, I've learned how to implement the metadata proposal, and have added some examples under &quot;Proposal B&quot; and a patch implementing it.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5242949.html#comment-5242949"
                id="comment-permalink-5242949"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5242949.html#comment-5242949"
    dc:identifier="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5242949.html#comment-5242949"
    dc:title="Overriding compile-time var values at expression-level granularity"
    trackback:ping="https://dev.clojure.org/rpc/trackback/5242949"/>
</rdf:RDF>
-->

                    
                                    <ol class="comment-threads">
                                        <li id="comment-thread-5242951" class="comment-thread">
                                <div class="comment  " id="comment-5242951">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: brandon@brandonbloom.name" title="brandon@brandonbloom.name">                </p>
                <p class="date" title="Jun 07, 2012 14:50">
                    Jun 07, 2012
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~brandon@brandonbloom.name.html"
                          class="url fn"
                   >Brandon Bloom</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>Patch link?</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5242951.html#comment-5242951"
                id="comment-permalink-5242951"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5242951.html#comment-5242951"
    dc:identifier="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5242951.html#comment-5242951"
    dc:title="Overriding compile-time var values at expression-level granularity"
    trackback:ping="https://dev.clojure.org/rpc/trackback/5242951"/>
</rdf:RDF>
-->

                    
                                    <ol class="comment-threads">
                                        <li id="comment-thread-5242952" class="comment-thread">
                                <div class="comment  " id="comment-5242952">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: andy.fingerhut" title="andy.fingerhut">                </p>
                <p class="date" title="Jun 07, 2012 15:27">
                    Jun 07, 2012
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~andy.fingerhut.html"
                          class="url fn"
                   >Andy Fingerhut</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>It is mentioned in the text in the Proposal B section.  Near the top right of this page, click on the Tools menu, then menu item Attachments.  The patch is called metadata-patch1.txt.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5242952.html#comment-5242952"
                id="comment-permalink-5242952"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5242952.html#comment-5242952"
    dc:identifier="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5242952.html#comment-5242952"
    dc:title="Overriding compile-time var values at expression-level granularity"
    trackback:ping="https://dev.clojure.org/rpc/trackback/5242952"/>
</rdf:RDF>
-->

                    
                                </li>
                                </ol>
                        </li>
                                </ol>
                        </li>
                                </ol>
                        </li>
                        <li id="comment-thread-5243069" class="comment-thread">
                                <div class="comment  " id="comment-5243069">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: stu" title="stu">                </p>
                <p class="date" title="Jul 23, 2012 07:57">
                    Jul 23, 2012
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~stu.html"
                          class="url fn"
                   >Stuart Halloway</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>Is reflection the primary use case motivating this? I ask because there might be ways to make the problem go away entirely. E.g., have the compiler walk all classes visible to a package and<strong> automatically </strong>eliminate reflection when there is no ambiguity.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5243069.html#comment-5243069"
                id="comment-permalink-5243069"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5243069.html#comment-5243069"
    dc:identifier="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5243069.html#comment-5243069"
    dc:title="Overriding compile-time var values at expression-level granularity"
    trackback:ping="https://dev.clojure.org/rpc/trackback/5243069"/>
</rdf:RDF>
-->

                    
                                    <ol class="comment-threads">
                                        <li id="comment-thread-5243073" class="comment-thread">
                                <div class="comment  " id="comment-5243073">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: andy.fingerhut" title="andy.fingerhut">                </p>
                <p class="date" title="Jul 23, 2012 09:42">
                    Jul 23, 2012
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~andy.fingerhut.html"
                          class="url fn"
                   >Andy Fingerhut</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>It was what motivated me personally.  The current patches allow you to do per-expression changes to *unchecked-math*, too, which might be useful to some people, although I haven't solicited or heard any feedback about how useful people would find that.  Although the attached patch doesn't implement it, the idea could be used to do per-subexpression assignments for the other options now in *compiler-options*, i.e. :elide-meta and :disable-locals-clearing, and such a patch should be able to automatically work for any new keys that might be added to *compiler-options* in the future.</p><p>In your scenario where the compiler automatically eliminated unambiguous reflection, would the behavior be to always warn about cases of ambiguous reflection, to always be silent about it, or to follow the current value of *warn-on-reflection*?  Maybe there would be far fewer cases of ambiguous reflection, but for whatever remains, we are in the same situation as we are today.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5243073.html#comment-5243073"
                id="comment-permalink-5243073"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5243073.html#comment-5243073"
    dc:identifier="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5243073.html#comment-5243073"
    dc:title="Overriding compile-time var values at expression-level granularity"
    trackback:ping="https://dev.clojure.org/rpc/trackback/5243073"/>
</rdf:RDF>
-->

                    
                                </li>
                                        <li id="comment-thread-5243074" class="comment-thread">
                                <div class="comment  " id="comment-5243074">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: andy.fingerhut" title="andy.fingerhut">                </p>
                <p class="date" title="Jul 23, 2012 09:46">
                    Jul 23, 2012
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~andy.fingerhut.html"
                          class="url fn"
                   >Andy Fingerhut</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>Out of curiosity, how have you and Rich been able to notice the new uses of reflection in the June and July 2012 commits to Clojure core?  By enabling *warn-on-reflection* by hand in the sections of code with changes?  Enabling it globally in the changed files or in all of Clojure core and doing a diff on the before- and after-patch compiler output?  Looking for them by eye and brain manually?</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5243074.html#comment-5243074"
                id="comment-permalink-5243074"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5243074.html#comment-5243074"
    dc:identifier="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5243074.html#comment-5243074"
    dc:title="Overriding compile-time var values at expression-level granularity"
    trackback:ping="https://dev.clojure.org/rpc/trackback/5243074"/>
</rdf:RDF>
-->

                    
                                    <ol class="comment-threads">
                                        <li id="comment-thread-5243084" class="comment-thread">
                                <div class="comment  " id="comment-5243084">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: stu" title="stu">                </p>
                <p class="date" title="Jul 27, 2012 14:05">
                    Jul 27, 2012
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~stu.html"
                          class="url fn"
                   >Stuart Halloway</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>I have used all of those except the diffing. Most are caught by code review, and a few in interactive REPL sessions. </p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5243084.html#comment-5243084"
                id="comment-permalink-5243084"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5243084.html#comment-5243084"
    dc:identifier="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5243084.html#comment-5243084"
    dc:title="Overriding compile-time var values at expression-level granularity"
    trackback:ping="https://dev.clojure.org/rpc/trackback/5243084"/>
</rdf:RDF>
-->

                    
                                    <ol class="comment-threads">
                                        <li id="comment-thread-5243087" class="comment-thread">
                                <div class="comment  " id="comment-5243087">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: andy.fingerhut" title="andy.fingerhut">                </p>
                <p class="date" title="Jul 27, 2012 15:01">
                    Jul 27, 2012
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~andy.fingerhut.html"
                          class="url fn"
                   >Andy Fingerhut</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>A small comment, then I'll try not to ask about it again for at least a couple of months <img class="emoticon emoticon-smile" src="../../s/en_GB/3047/3/_/images/icons/emoticons/smile.png" data-emoticon-name="smile" alt="Smile" /></p><p>If:</p><p>(1) we did something like this enhancement in Clojure</p><p>(2) we then eliminated all reflection warnings in Clojure core, either by type hints, or marking them with (known-reflection ...).  There were around 30 to 40 of them last I checked around Feb 2012, and many can easily be type-hinted away.</p><p>and</p><p>(3) we enabled *warn-on-reflection* by default in all Clojure core builds, e.g. by uncommenting this line in build.xml:</p><p>&lt;!-- &lt;sysproperty key=&quot;clojure.compile.warn-on-reflection&quot; value=&quot;true&quot;/&gt; --&gt;</p><p>then the prescreening process would automatically detect any proposed patch that introduced new reflection warnings, because it automatically detects any compile time warnings and marks such patches as not ready yet.  The only possible uses of reflection that could be introduced by a patch would be called out explicitly in the source code with (known-reflection ...) or ^{:warn-on-reflection false}.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5243087.html#comment-5243087"
                id="comment-permalink-5243087"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5243087.html#comment-5243087"
    dc:identifier="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5243087.html#comment-5243087"
    dc:title="Overriding compile-time var values at expression-level granularity"
    trackback:ping="https://dev.clojure.org/rpc/trackback/5243087"/>
</rdf:RDF>
-->

                    
                                </li>
                                </ol>
                        </li>
                                </ol>
                        </li>
                                </ol>
                        </li>
                        <li id="comment-thread-5243085" class="comment-thread">
                                <div class="comment  " id="comment-5243085">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: stu" title="stu">                </p>
                <p class="date" title="Jul 27, 2012 14:06">
                    Jul 27, 2012
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~stu.html"
                          class="url fn"
                   >Stuart Halloway</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>I don't have a strong enough feel on this to push for getting it into 1.5, but I am thinking about it.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5243085.html#comment-5243085"
                id="comment-permalink-5243085"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5243085.html#comment-5243085"
    dc:identifier="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=5243085.html#comment-5243085"
    dc:title="Overriding compile-time var values at expression-level granularity"
    trackback:ping="https://dev.clojure.org/rpc/trackback/5243085"/>
</rdf:RDF>
-->

                    
                                </li>
                        <li id="comment-thread-7700501" class="comment-thread">
                                <div class="comment  " id="comment-7700501">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: richhickey" title="richhickey">                </p>
                <p class="date" title="Apr 12, 2013 09:35">
                    Apr 12, 2013
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~richhickey.html"
                          class="url fn"
                   >Rich Hickey</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>While interesting, I don't consider this a priority, and it's a big feature to support a small benefit (warn-on-reflection true by default). There may be other ways to achieve that, and it might be practically untenable anyway due to the effect on existing codebases.</p><p>If we get build modes we might be able to do this there</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=7700501.html#comment-7700501"
                id="comment-permalink-7700501"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=7700501.html#comment-7700501"
    dc:identifier="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=7700501.html#comment-7700501"
    dc:title="Overriding compile-time var values at expression-level granularity"
    trackback:ping="https://dev.clojure.org/rpc/trackback/7700501"/>
</rdf:RDF>
-->

                    
                                    <ol class="comment-threads">
                                        <li id="comment-thread-7700510" class="comment-thread">
                                <div class="comment  " id="comment-7700510">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: bbloom" title="bbloom">                </p>
                <p class="date" title="Apr 12, 2013 10:06">
                    Apr 12, 2013
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~bbloom.html"
                          class="url fn"
                   >Brandon Bloom</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>By &quot;build modes&quot; do you mean the same thing as &quot;build profiles&quot;?</p><p><a href="Build+Profiles.html" class="external-link" rel="nofollow">http://dev.clojure.org/display/design/Build+Profiles</a></p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=7700510.html#comment-7700510"
                id="comment-permalink-7700510"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=7700510.html#comment-7700510"
    dc:identifier="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=7700510.html#comment-7700510"
    dc:title="Overriding compile-time var values at expression-level granularity"
    trackback:ping="https://dev.clojure.org/rpc/trackback/7700510"/>
</rdf:RDF>
-->

                    
                                    <ol class="comment-threads">
                                        <li id="comment-thread-7700511" class="comment-thread">
                                <div class="comment  " id="comment-7700511">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: richhickey" title="richhickey">                </p>
                <p class="date" title="Apr 12, 2013 10:34">
                    Apr 12, 2013
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~richhickey.html"
                          class="url fn"
                   >Rich Hickey</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>yes</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=7700511.html#comment-7700511"
                id="comment-permalink-7700511"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=7700511.html#comment-7700511"
    dc:identifier="Overriding+compile-time+var+values+at+expression-level+granularity-focusedCommentId=7700511.html#comment-7700511"
    dc:title="Overriding compile-time var values at expression-level granularity"
    trackback:ping="https://dev.clojure.org/rpc/trackback/7700511"/>
</rdf:RDF>
-->

                    
                                </li>
                                </ol>
                        </li>
                                </ol>
                        </li>
                </ol>
    
    </div>


            
</div>


    



    
    

    
    
    


    



    <br class="clear">
</div>
  
    </div>
</div>

<div id="footer">
                                                <p class="license license-opensource">
                  Powered by a free <b>Atlassian Confluence Open Source Project License</b> granted to Clojure. <a href="http://www.atlassian.com/c/conf/11461">Evaluate Confluence today</a>.<br>
                </p>
                        
    <ul id="poweredby">
        <li class="noprint">Powered by <a href="http://www.atlassian.com/software/confluence" class="hover-footer-link">Atlassian Confluence</a> <span id='footer-build-information'>4.0</span>, the <a href="http://www.atlassian.com/software/confluence/tour/enterprise-wiki.jsp" class="hover-footer-link">Enterprise Wiki</a></li>
        <li class="print-only">Printed by Atlassian Confluence 4.0, the Enterprise Wiki.</li>        
        <li class="noprint"> &nbsp; |&nbsp; <a href="http://jira.atlassian.com/secure/BrowseProject.jspa?id=10470" class="hover-footer-link">Report a bug</a></li>
        <li class="noprint"> &nbsp;|&nbsp; <a href="http://www.atlassian.com/about/connected.jsp?s_kwcid=Confluence-stayintouch" class="hover-footer-link">Atlassian News</a></li>
    </ul>

    

            <div><span style="">Site support by</span><a href="http://contegix.com"> <img style="vertical-align:middle" src="../../download/attachments/459015/contegix.jpg.html"/></a></div>
    </div></div>
</body>
</html>
