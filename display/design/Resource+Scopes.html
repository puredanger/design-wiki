
<!DOCTYPE html>
<html>
<head>
    <title>Resource Scopes - Clojure Design - Clojure Development</title>

        

                        
    

            <meta http-equiv="X-UA-Compatible" content="IE=EDGE">
<meta charset="UTF-8">
<!-- Deprecated since 3.4. To be removed in a future version of Confluence; use AJS.Confluence.getContextPath() -->
<meta id="confluence-context-path" name="confluence-context-path" content="">
<meta id="confluence-base-url" name="confluence-base-url" content="https://dev.clojure.org">

<meta id="atlassian-token" name="atlassian-token" content="30041c830a95ce9c95d0b58cb377def6b96aa6d2">

<meta id="confluence-space-key" name="confluence-space-key" content="design">
<script type="text/javascript">
    // Deprecated global variables. To be removed in a future version of Confluence.
    var contextPath = '';
</script>

    

<!-- include system css resources -->


    <link type="text/css" rel="stylesheet" href="../../s/en_GB/3047/3/55/u/download/superbatch/css/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/en_GB/3047/3/55/u/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if IE 9]>
<link type="text/css" rel="stylesheet" href="/s/en_GB/3047/3/55/u/download/superbatch/css/batch.css?conditionalComment=IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/en_GB/3047/3/55/u/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/3047/3/55/u/download/superbatch/css/batch-media=print.css" media="print">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/en_GB/3047/3/961a0823b948d2f215d5a69c25b0d622/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/3047/3/961a0823b948d2f215d5a69c25b0d622/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/en_GB/3047/3/c80b4ecc4b1853e829650e7c54066b66/_/download/contextbatch/css/viewcontent,main/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/3047/3/c80b4ecc4b1853e829650e7c54066b66/_/download/contextbatch/css/viewcontent,main/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/3047/3/2.0.6/_/download/batch/com.atlassian.confluence.ext.newcode-macro-plugin-syntaxhighlighter/com.atlassian.confluence.ext.newcode-macro-plugin-syntaxhighlighter.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/3047/3/2.0.6/_/download/batch/com.atlassian.confluence.ext.newcode-macro-plugin-sh-theme-confluence/com.atlassian.confluence.ext.newcode-macro-plugin-sh-theme-confluence.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/3047/3/2.0.1/_/download/batch/com.atlassian.confluence.plugins.pagetree-pagetree-resources/com.atlassian.confluence.plugins.pagetree-pagetree-resources.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/3047/3/3/_/styles/colors-spaceKey=design.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/3047/3/2.0.5/_/download/resources/com.atlassian.confluence.plugins.doctheme-documentation/default-theme.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/3047/3/2.0.5/_/download/resources/com.atlassian.confluence.plugins.doctheme-documentation/splitter.css" media="all">

<!-- end system css resources -->

    <meta name="confluence-request-time" content="1556129494825">
            <meta name="ajs-page-id" content="458779">
            <meta name="ajs-parent-page-id" content="950453">
            <meta name="ajs-space-key" content="design">
            <meta name="ajs-space-name" content="Clojure Design">
            <meta name="ajs-page-title" content="Resource Scopes">
            <meta name="ajs-parent-page-title" content="State, Concurrency, and Parallelism">
            <meta name="ajs-from-page-title" content="">
            <meta name="ajs-context-path" content="">
            <meta name="ajs-version-number" content="4.0">
            <meta name="ajs-build-number" content="3047">
            <meta name="ajs-remote-user" content="">
            <meta name="ajs-static-resource-url-prefix" content="/s/en_GB/3047/3/_">
            <meta name="ajs-global-settings-attachment-max-size" content="10485760">
            <meta name="ajs-user-locale" content="en_GB">
            <meta name="ajs-enabled-dark-features" content="">
            <meta name="ajs-atl-token" content="30041c830a95ce9c95d0b58cb377def6b96aa6d2">
            
            <meta name="ajs-keyboardshortcut-hash" content="7b95af54c6deada096af1f28fdd0f413">
            <meta name="ajs-use-keyboard-shortcuts" content="true">
    <!-- Deprecated since 3.4. To be removed in a future version of Confluence; use atl.header -->
        
            <script type="text/x-template" title="share-content-popup">
    <form action="#" method="post" class="aui share-content-popup">
        <fieldset>
            <label for="users">User name or email</label>
            <div class="autocomplete-user-target">
                <input class="text autocomplete-sharepage" id="users" data-max="10" data-dropdown-target=".autocomplete-user-target" data-none-message="No matching user or email found"/>
            </div>
            <ol class="recipients">
            </ol>
            <div><label for="note">Note</label></div>
            <textarea class="textarea" id="note" placeholder="Add an optional note"/>
        </fieldset>
        <div class="button-panel">
            <div class="progress-messages-icon"></div>
            <div class="progress-messages">
            </div>
            <input class="button submit" type="submit" value="Share" disabled/>
            <a class="close-dialog" href="#">Cancel</a>
        </div>
    </form>
</script>

<script type="text/x-template" title="share-content-popup-recipient-username">
    <li data-username="{username}" style="display: none">
        <span>
            <img src="{thumbnailLink.href}" title="{title}">
            <span>{title}</span>
            <span class="remove-recipient"/>
        </span>
    </li>
</script>

<script type="text/x-template" title="share-content-popup-recipient-email">
    <li data-email="{email}" style="display: none">
        <span>
            <img src="{icon}" title="{email}">
            <span>{email}</span>
            <span class="remove-recipient"/>
        </span>
    </li>
</script>
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="icon" type="image/png" href="../../s/en_GB/3047/3/_/images/logo/confluence_16.png">

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch/osd.action.xml" title="Clojure Development"/>

        <!-- include system javascript resources -->
                        
    
    <script type="text/javascript" src="../../s/en_GB/3047/3/55/u/download/superbatch/js/batch.js" ></script>
<!--[if lte IE 8]>
<script type="text/javascript" src="/s/en_GB/3047/3/55/u/download/superbatch/js/batch.js?conditionalComment=lte+IE+8" ></script>
<![endif]-->
<script type="text/javascript" src="../../s/en_GB/3047/3/961a0823b948d2f215d5a69c25b0d622/_/download/contextbatch/js/page/batch.js" ></script>
<script type="text/javascript" src="../../s/en_GB/3047/3/c80b4ecc4b1853e829650e7c54066b66/_/download/contextbatch/js/viewcontent,main/batch.js" ></script>
<script type="text/javascript" src="../../s/en_GB/3047/3/2.0.6/_/download/batch/com.atlassian.confluence.ext.newcode-macro-plugin-syntaxhighlighter/com.atlassian.confluence.ext.newcode-macro-plugin-syntaxhighlighter.js" ></script>
<script type="text/javascript" src="../../s/en_GB/3047/3/2.0.6/_/download/batch/com.atlassian.confluence.ext.newcode-macro-plugin-syntaxhighlighter-brushes/com.atlassian.confluence.ext.newcode-macro-plugin-syntaxhighlighter-brushes.js" ></script>
<script type="text/javascript" src="../../s/en_GB/3047/3/2.0.1/_/download/batch/com.atlassian.confluence.plugins.pagetree-pagetree-resources/com.atlassian.confluence.plugins.pagetree-pagetree-resources.js" ></script>

    
    <!-- end system javascript resources -->

    

    
    <link rel="canonical" href="Resource+Scopes.html">
    <link rel="shortlink" href="Resource+Scopes.html">
    <meta name="wikilink" content="[design:Resource Scopes]">
    <meta name="page-version" content="15">

</head>

<body             onload="placeFocus()"
     id="com-atlassian-confluence" class="theme-documentation ">
<div id="full-height-container">
    <div id="header-precursor">
        
        
                </div>

<div id="header" class="sectionbottom ">
        <form id="quick-search" class="quick-search" method="get" action="../../dosearchsite.action.html">
                <fieldset>
            <input type="hidden" name="spaceSearch" value="false"/>
        </fieldset>
        <fieldset>
            <legend>Quick Search</legend>
            <input class="quick-search-query" id="quick-search-query" type="text" accessKey="search-pages-action.accesskey" autocomplete="off" name="queryString" size="25"/>
            <input class="quick-search-submit" id="quick-search-submit" type="submit"  value="Search Confluence" />
            <div class="aui-dd-parent quick-nav-drop-down"><!-- Quick nav appears here --></div>
        </fieldset>
        <fieldset class="hidden parameters">
            <input type="hidden" id="quickNavEnabled" value="true" />
                    </fieldset>
    </form>

    <ul id="header-menu-bar" class="ajs-menu-bar">
                    
        
            <li class="normal ajs-menu-item">
        <a id="browse-menu-link" class="browse trigger ajs-menu-title" href="#"><span><span>Browse</span></span></a>         <div class="assistive ajs-drop-down">
                        <ul  id="browse-menu-link-leading"                 class="section-leading first">
                                        <li>
    
        
    
    <a  id="space-pages-link" href="../../pages/recentlyupdated.action-key=design.html"  class=""   title="Browse pages in the Clojure Design space">
                   <span>Pages</span></a>        </li>
                                        <li>
    
        
    
    <a  id="space-blogposts-link" href="../../pages/viewrecentblogposts.action-key=design.html"  class=""   title="Browse blogs in the Clojure Design space">
                   <span>Blog</span></a>        </li>
                                        <li>
    
        
    
    <a  id="space-labels-link" href="../../labels/listlabels-heatmap.action-key=design.html"  class=""   title="Browse labels in the Clojure Design space">
                   <span>Labels</span></a>        </li>
                                        <li>
    
        
    
    <a  id="space-attachments-link" href="../../spaces/listattachmentsforspace.action-key=design.html"  class=""   title="Browse attachments in the Clojure Design space">
                   <span>Attachments</span></a>        </li>
                                        <li>
    
        
    
    <a  id="space-mail-link" href="../../spaces/viewmailarchive.action-key=design.html"  class=""   title="Browse mail in the Clojure Design space">
                   <span>Mail</span></a>        </li>
                                        <li>
    
        
    
    <a  id="space-advanced-link" href="../../spaces/viewspacesummary.action-key=design.html"  class=""   title="Browse additional space functions in the Clojure Design space">
                   <span>Advanced</span></a>        </li>
                            </ul>
                        <ul  id="browse-menu-link-global"                 class="section-global">
                                        <li>
    
        
    
    <a  id="whats-new-menu-link" href="http://docs.atlassian.com/confluence/docs-40/whatsnew/iframe"  class=""   title="">
                   <span>What’s New</span></a>        </li>
                                        <li>
    
        
    
    <a  id="space-directory-link" href="../../spacedirectory/view.action.html"  class=""   title="Browse the Confluence space directory">
                   <span>Space Directory</span></a>        </li>
                                        <li>
    
        
    
    <a  id="feed-builder-link" href="../../dashboard/configurerssfeed.action.html"  class=""   title="Create your custom RSS feed.">
                   <span>Feed Builder</span></a>        </li>
                                        <li>
    
            
    
    <a  id="keyboard-shortcuts-link" href="#"  class=""   title="View available keyboard shortcuts">
                   <span>Keyboard Shortcuts</span></a>        </li>
                                        <li>
    
            
    
    <a  id="gadget-directory-link" href="#"  class="user-item administration-link"   title="Browse gadgets provided by Confluence">
                   <span>Confluence Gadgets</span></a>        </li>
                            </ul>
                    </div>
    </li>
        
                                                         <li class="ajs-menu-item normal">
        
        
    
    <a  id="login-link" href="https://dev.clojure.org/login.action?os_destination=%2Fdisplay%2Fdesign%2FResource%2BScopes"  class="user-item login-link"   title="">
                   <span>Log In</span></a>        </li>
                            <li class="ajs-menu-item normal">
    
        
    
    <a  id="signup-link" href="../../signup.action.html"  class="user-item signup-link"   title="">
                   <span>Sign Up</span></a>        </li>
                                <li class="normal ajs-menu-item">
            <div id="splitter-button" class="hidden" title="Show or hide sidebar"></div>
        </li>

    </ul>
    
    
    <ol id="breadcrumbs">
                    
                        
        <li class="first" >
                                    <span><a href="../../dashboard.action.html" title="Go to Dashboard">Dashboard</a></span>
                </li>
                    
                
        <li>
                                    <span><a href="Home-jsessionid=3A56E29DA520B75101350BA4484B9990.html">Clojure Design</a></span>
                </li>
                                        <li id="ellipsis" title="Show all breadcrumbs"><span><strong>&#8230;</strong></span></li>
                                    
                
        <li class="hidden-crumb" >
                                    <span><a href="Home.html">Home</a></span>
                </li>
                                
                
        <li class="hidden-crumb" >
                                    <span><a href="Idea+Hammock.html">Idea Hammock</a></span>
                </li>
                                
                
        <li class="hidden-crumb" >
                                    <span><a href="State,+Concurrency,+and+Parallelism.html">State, Concurrency, and Parallelism</a></span>
                </li>
                    
                
        <li>
                                    <span><a href="Resource+Scopes.html">Resource Scopes</a></span>
                </li>
        </ol>

</div>

    <div id="splitter">
    <div id="splitter-sidebar" >
        

                    
        
    

<div class="plugin_pagetree">

                <div id="pagetreesearch">
            <form method="POST" action="../../dosearchsite.action-searchQuery.queryString=&amp;searchQuery.spaceKey=conf_all.html" name="pagetreesearchform">
                                    <input type="hidden" name="ancestorId" value="458775">
                                <input type="hidden" name="spaceKey" value="design">
                <input type="text"  size="20" name="queryString">
                <input type="submit" value="Search">
            </form>
        </div>
    
        
    <ul class="plugin_pagetree_children_list plugin_pagetree_children_list_noleftspace">
        <div class="plugin_pagetree_children">
        </div>
    </ul>

    <fieldset class="hidden">
        <input type="hidden" name="treeId" value="">
        <input type="hidden" name="treeRequestId" value="/plugins/pagetree/naturalchildren.action?decorator=none&amp;excerpt=false&amp;sort=position&amp;reverse=false&amp;disableLinks=false">
        <input type="hidden" name="treePageId" value="458779">

        <input type="hidden" name="noRoot" value="false">
        <input type="hidden" name="rootPageId" value="458775">

        <input type="hidden" name="rootPage" value="">
        <input type="hidden" name="startDepth" value="0">
        <input type="hidden" name="spaceKey" value="design" >

        <input type="hidden" name="i18n-pagetree.loading" value="Loading...">
        <input type="hidden" name="i18n-pagetree.error.permission" value="Unable to load page tree. It seems that you do not have permission to view the root page.">
        <input type="hidden" name="i18n-pagetree.eeror.general" value="There was a problem retrieving the page tree. Please check the server log file for more information.">
        <input type="hidden" name="loginUrl" value="/login.action?os_destination=%2Fdisplay%2Fdesign%2FResource%2BScopes">

                <fieldset class="hidden">
                                                <input type="hidden" name="ancestorId" value="950453">
                                    <input type="hidden" name="ancestorId" value="8192213">
                                    <input type="hidden" name="ancestorId" value="458775">
                                    </fieldset>
    </fieldset>
</div>



            </div>
    <div id="splitter-content">

                    <script type="text/javascript" src="../../s/en_GB/3047/3/2.0.5/_/download/resources/com.atlassian.confluence.plugins.doctheme-resources/doc-theme.js"></script>
    
            
    
<div id="main" >
    <div id="main-header">
	    
	    
    <div id="navigation" class="content-navigation view">
                    <ul class="ajs-menu-bar">
                                
                        
            <li class="normal ajs-menu-item">
        <a id="action-menu-link" class="action trigger ajs-menu-title" href="#"><span><span>Tools</span></span></a>         <div class="assistive ajs-drop-down">
                        <ul  id="action-menu-link-primary"                 class="section-primary first">
                                        <li>
    
        
    
    <a  id="view-attachments-link" href="https://dev.clojure.org/pages/viewpageattachments.action?pageId=458779"  class="action-view-attachments"  accessKey="a"  title="View Attachments">
                   <span><u>A</u>ttachments (0)</span></a>        </li>
                                        <li>
    
        
    
    <a  id="action-view-history-link" href="https://dev.clojure.org/pages/viewpreviousversions.action?pageId=458779"  class="action-view-history"   title="">
                   <span>Page History</span></a>        </li>
                                        <li>
    
        
    
    <a  id="action-page-permissions-link" href="https://dev.clojure.org/pages/viewinfo.action?pageId=458779"  class="action-page-permissions"   title="Edit restrictions">
                   <span>Restrictions</span></a>        </li>
                            </ul>
                        <ul  id="action-menu-link-secondary"                 class="section-secondary">
                                        <li>
    
        
    
    <a  id="view-page-info-link" href="https://dev.clojure.org/pages/viewinfo.action?pageId=458779"  class="action-view-info"   title="">
                   <span>Info</span></a>        </li>
                                        <li>
    
        
    
    <a  id="link-to-page-link" href="https://dev.clojure.org/pages/viewinfo.action?pageId=458779"  class=""   title="Link to this Page">
                   <span>Link to this Page&hellip;</span></a>        </li>
                                        <li>
    
        
    
    <a  id="view-in-hierarchy-link" href="../../pages/listpages-dirview.action-key=design&amp;openId=458779.html#selectedPageInHierarchy"  class=""   title="">
                   <span>View in Hierarchy</span></a>        </li>
                                        <li>
    
        
    
    <a  id="action-view-source-link" href="https://dev.clojure.org/plugins/viewsource/viewpagesrc.action?pageId=458779"  class="action-view-source popup-link"   title="">
                   <span>View Source</span></a>        </li>
                            </ul>
                    </div>
    </li>
            </ul>
    </div>

	    
	    <h1 id="title-heading" class="pagetitle">
	        	            <a href="Home-jsessionid=3A56E29DA520B75101350BA4484B9990.html"><img class="logo global custom" src="../../download/attachments/131074/global.logo.png" alt=""></a>	        	
			<span id="title-text">
							            <a href="Resource+Scopes.html">Resource Scopes</a>
    						</span>
	    </h1>
	</div>

    

    
    
    
    
    

                                                                                                                                                                                                                                                                                                                                                                                                                                                                      




        













    
    
        
    
    
                    
    

    


<div id="content" class="page view">
    



                
<script type="text/x-template" title="movePageDialog">
    <div class="row information">
        <div class="inner">
            <div class="element">
                Specify the new parent page for this page and its children by space and title.
            </div>
        </div>
    </div>
    <div class="form">
        <fieldset>
                

    <legend class="assistive"><span>Change the Parent Page to a Known Page</span></legend>
            <div class="row">
                <label for="new-space">New space:</label>
                <div class="value new-space-value">
                    <input id="new-space-key" name="new-space-key" type="hidden" value="design">
                                            <span class="space-input">
                            <input id="new-space" name="new-space" value="Clojure Design" disabled="disabled">
                        </span>
                        <span class="description warning">You cannot move this page to another space because you do not have permission to remove it from this space.</span>
                                        <div class="new-space-dropdown aui-dd-parent autocomplete"></div>
                </div>
            </div>
            <div class="row">
                <label for="new-parent-page">New parent page:</label>
                <div class="value new-parent-page-value">
                    <span class="page-input">
                        <input id="new-parent-page" name="new-parent-page" value="State, Concurrency, and Parallelism">
                    </span>
                    <span class="description">Start typing a page title to see a list of suggestions.</span>
                    <div class="new-parent-page-dropdown aui-dd-parent autocomplete"></div>
                </div>
            </div>
        </fieldset>
    </div>
    <div class="location-info">
        <div class="row">
            <label>Current location:</label>
            <div class="value breadcrumbs-container">
                <div class="breadcrumbs-line">
                    <ul id="current-parent-breadcrumbs" class="breadcrumbs">
                    </ul>
                </div>
            </div>
        </div>
        <div class="row">
            <label>New location:</label>
            <div class="value breadcrumbs-container">
                <div class="breadcrumbs-line">
                    <ul id="new-parent-breadcrumbs" class="breadcrumbs">
                    </ul>
                </div>
            </div>
        </div>
    </div>
</script>

<script type="text/x-template" title="movePageSearchPanel">
    <div class="row information">
        <div class="inner">
            <div class="element">
                Search for and select the new parent page for this page and its children.
            </div>
        </div>
    </div>
    <div id="move-page-search-container" class="row">
        <div class="search-form">
            <fieldset>
                    

    <legend class="assistive"><span>Search for a New Parent Page</span></legend>
                    

    <label  for="move-page-search-query" class="assistive">Search keywords</label>
                <input class="search-query" id="move-page-search-query">
                    

    <label  for="move-page-search-space" class="assistive">Search in space</label>
                                    <select id="move-page-search-space" class="search-space" disabled="disabled">
                        <option value="design" selected="selected">Clojure Design</option>
                    </select>
                                <input type="button" value="Search">
                                    <div class="description warning">You cannot move this page to another space because you do not have permission to remove it from this space.</div>
                            </fieldset>
        </div>
        <div class="search-results">
        </div>
    </div>
</script>
<script type="text/x-template" title="searchResultsGrid">
    <table>
        <thead>
            <tr class="header">
                <th class="search-result-title">Page Title</th>
                <th class="search-result-space">Space</th>
                <th class="search-result-date">Updated</th>
            </tr>
        </thead>
    </table>
</script>
<script type="text/x-template" title="searchResultsGridCount">
    <p class="search-result-count">{0}</p>
</script>
<script type="text/x-template" title="searchResultsGridRow">
    <tr class="search-result">
        <th class="search-result-title"><a href="{1}" class="content-type-{2}"><span>{0}</span></a></th>
        <td class="search-result-space"><a class="space" href="/display/{4}/" title="{3}">{3}</a></td>
        <td class="search-result-date"><span class="date" title="{6}">{5}</span></td>
    </tr>
</script><!-- Start restrictions section -->
<script type="text/x-template" title="page-permissions-div">
<div id="page-permissions-div">
    <div id="page-permissions-editor-form">

                <div id="page-permissions-error-div" class="hidden">
            <a href="#" id="permissions-error-div-close">Ok</a>
            <div></div>
        </div>

                <div id="page-permissions-type-radios" class="page-permissions-label-rows">
            <div>
                <input id="restrictViewRadio" type="radio" checked="checked" name="pagePermissionTypeRadio" value="view"/>
                <label for="restrictViewRadio">Restrict viewing of this page</label>
                <input id="restrictEditRadio" type="radio" name="pagePermissionTypeRadio" value="edit"/>
                <label for="restrictEditRadio">Restrict editing of this page</label>
            </div>
        </div>
        <div id="page-permissions-input" class="page-permissions-label-rows">
            <div class="page-permissions-label">To:</div>
            <div id="page-permissions-chooser-box">
                                <span id="page-permissions-choose-user" class="ajs-button">
                    



    



<a href="#" id='userpicker-popup-link-image' onClick="var picker = window.open('/spaces/openuserpicker.action?key=design&amp;startIndex=0&amp;onPopupSubmit=AJS.PagePermissions.addUserPermissions', 'EntitiesPicker', 'status=yes,resizable=yes,top=100,left=200,width=700,height=680,scrollbars=yes'); picker.focus(); return false;"><img src="/s/en_GB/3047/3/_/images/icons/user_16.gif" height=16 width=16 border=0 align="absmiddle"  title="Choose users" /></a>
<a href="#" id='userpicker-popup-link-text' onClick="var picker = window.open('/spaces/openuserpicker.action?key=design&amp;startIndex=0&amp;onPopupSubmit=AJS.PagePermissions.addUserPermissions', 'EntitiesPicker', 'status=yes,resizable=yes,top=100,left=200,width=700,height=680,scrollbars=yes'); picker.focus(); return false;">Person...</a>


                </span>
                <span id="page-permissions-choose-group" class="ajs-button">
                    



    

 

<a href="#" id='grouppicker-popup-link-image' onClick="var picker = window.open('/spaces/opengrouppicker.action?key=design&amp;startIndex=0&amp;actionName=dosearchgroups.action&amp;onPopupSubmit=AJS.PagePermissions.addGroupPermissions', 'EntitiesPicker', 'status=yes,resizable=yes,top=100,left=200,width=580,height=550,scrollbars=yes'); picker.focus(); return false;"><img src="/s/en_GB/3047/3/_/images/icons/group_16.gif" height=16 width=16 border=0 align="absmiddle"  title="Choose groups" /></a>
<a href="#" id='grouppicker-popup-link-text' onClick="var picker = window.open('/spaces/opengrouppicker.action?key=design&amp;startIndex=0&amp;actionName=dosearchgroups.action&amp;onPopupSubmit=AJS.PagePermissions.addGroupPermissions', 'EntitiesPicker', 'status=yes,resizable=yes,top=100,left=200,width=580,height=550,scrollbars=yes'); picker.focus(); return false;">Group...</a>


                </span>
            </div>
            <div id="page-permissions-input-box">
                <input type="text" id="page-permissions-names-input" name="permissionNames"
                    placeholder="Enter user or group name" class="autocomplete-user"
                    data-max="10" data-none-message="No matches"
                    data-target="#page-permissions-names-hidden" data-template="{username}"
                    data-dropdown-target="#page-perms-name-dropdown-wrapper" data-resize-to-input="true"
                    size="30"/>
                <input
    type="hidden"
                            id="page-permissions-names-hidden"           />                <img height="16px" width="1px" src="/s/en_GB/3047/3/_/images/border/spacer.gif"/>
                <input type="button" id="add-typed-names" value="Restrict">
                <div id="page-perms-name-dropdown-wrapper" class="aui-dd-parent autocomplete"></div>
            </div>
        </div>
    </div>
    <div id="page-permissions-tables">
        <div id="page-permissions-table-div">
                        <table id="page-permissions-table" class="page-permissions-table">
                <tr id="page-permissions-no-views" class="marker-row">
                    <td colspan="3" class="page-permissions-marker-cell"><span>No view restrictions are defined for this page</span></td>
                </tr>
                <tr id="page-permissions-no-edits" class="marker-row">
                    <td colspan="3" class="page-permissions-marker-cell"><span>No edit restrictions are defined for this page</span></td>
                </tr>
            </table>
        </div>
        <div id="page-inherited-permissions-table-div" class="hidden">
            <span id="page-inherited-permissions-table-desc">
                <a class="icon twisty-closed">Show/Hide</a>
                <a id="toggle-inherited-permissions" title="Click to see inherited restrictions">This page has restricted parent pages. It can only be seen by users who can see those parent pages.</a>
            </span>
            <div id="page-inherited-permissions-tables" class="hidden page-inheritance-togglable"></div>
        </div>
    </div>
</div>
</script>

<!-- End restrictions section -->

        
    
    
        <fieldset class="hidden parameters">
            <input type="hidden" title="parentPageId" value="950453">
        </fieldset>

        
                            
    

                    

        
        <a href="#page-metadata-end" class="assistive">Skip to end of metadata</a>
<div id="page-metadata-start" class="assistive"></div>

    <div class="page-metadata">
        <ul>
                            <li class="page-metadata-item noprint">
    
            
    
    <a  id="content-metadata-page-restrictions" href="#"  class="page-metadata-icon page-restrictions hidden"   title="Page restrictions apply. Click the lock icon to view or edit the restriction.">
                   <span>Page restrictions apply</span></a>        </li>
                        <li class="page-metadata-modification-info">
                                    Added by <a href="../../login.action-os_destination=-display-~richhickey.html"
                          class="url fn"
                   >Rich Hickey</a>, last edited by <a href="../../login.action-os_destination=-display-~stu.html"
                          class="url fn"
                   >Stuart Halloway</a> on Jul 12, 2011
                                                                <span class="noprint">&nbsp;(<a id="view-change-link" href="https://dev.clojure.org/pages/diffpages.action?pageId=458779&amp;originalId=3309575">view change</a>)</span>
                                                </li>
                            <li class="show-hide-comment-link">
                    <a id="show-version-comment" class="inline-control-link" href="#">show comment</a>
                    <a id="hide-version-comment" class="inline-control-link" style="display:none;" href="#">hide comment</a>
                </li>
                    </ul>
                <div id="version-comment" class="noteMacro">
        <strong>Comment:</strong>
        Migrated to Confluence 4.0<br />
    </div>
        </div>


<a href="#page-metadata-start" class="assistive">Go to start of metadata</a>
<div id="page-metadata-end" class="assistive"></div>
        
        <fieldset class="hidden parameters">
                        <input type="hidden" title="browsePageTreeMode" value="view">
        </fieldset>

        <div class="wiki-content">
                           <h3 id="ResourceScopes-Rationale">Rationale</h3>

<p>It can be difficult to manage resource lifetimes, especially when laziness is involved. Simply local scoping can be inadequate. Resource scopes can decouple resource lifetimes from creating scope.</p>

<h3 id="ResourceScopes-Plan">Plan</h3>

<ul>
	<li>Generalize from resource scopes to general scopes (succeed/fail/exit)</li>
	<li>with-open et al make scopes</li>
	<li>Some design work and code has been done
	<ul>
		<li>find it and write it up</li>
		<li><a href="http://github.com/clojure/clojure/blob/streams/src/clj/clojure/core.clj#L2005)" class="external-link" rel="nofollow">scope work in streams branch</a></li>
	</ul>
	</li>
</ul>


<h3 id="ResourceScopes-UseCases">Use Cases</h3>

<ul>
	<li>REPL usage: open stream and it closes before I lazily consume it. Doh!</li>
	<li>Start an activity, and then have nested resource lifetime automatically tie to it
	<ul>
		<li>Task A calls Iib B which allocates resources</li>
	</ul>
	</li>
	<li>Prevent resource lifetimes from nesting
	<ul>
		<li>lib C knows it doesn't want its lifetime governed by Task A</li>
	</ul>
	</li>
	<li>All works across threads</li>
</ul>


<h3 id="ResourceScopes-Problems">Problems</h3>

<ul>
	<li>Other than memory allocation, the proper freeing of resources (e.g. closing open files) is on the user
	<ul>
		<li>thus, easy to get wrong</li>
	</ul>
	</li>
	<li>'He who acquires releases' is one strategy
	<ul>
		<li>can be automated, e.g. with-xxx
		<ul>
			<li>but with-xxx puts an envelope around the availability of the resource, tied to the acquirer</li>
			<li>we trip over this when we create and return lazy seqs that reference resources</li>
			<li>anywhere else?, could we limit the scope of the solution to lazy seqs?
			<ul>
				<li>even then, needs care</li>
				<li>e.g. closing on seq exhaustion not triggered by partial consumption</li>
			</ul>
			</li>
		</ul>
		</li>
	</ul>
	</li>
	<li>piggybacking on GC gets around this
	<ul>
		<li>i.e. finalizers</li>
		<li>but is bad, because we can't know when/if they will run
		<ul>
			<li>non-option?</li>
		</ul>
		</li>
	</ul>
	</li>
	<li>reference counting works in some langs
	<ul>
		<li>but not on the JVM where aliasing is common and undetectable</li>
		<li>is it possible to wrap resources with a counter/tracker?
		<ul>
			<li>open question</li>
		</ul>
		</li>
	</ul>
	</li>
	<li>can tag things as closable and call close everywhere defensively
	<ul>
		<li>but everywhere is a big and dangerous place</li>
	</ul>
	</li>
	<li>Fundamentally - how do you know when something is (or contains) a 'resource'
	<ul>
		<li>and how do you know when no one cares about it anymore?
		<ul>
			<li>and what does it mean to care?</li>
			<li>could just fold down to  - care means would be unhappy if closed</li>
		</ul>
		</li>
		<li>and what needs to be done about it when that is the case?
		<ul>
			<li>who knows what that is?</li>
		</ul>
		</li>
	</ul>
	</li>
	<li>Is the problem as simple as closing?
	<ul>
		<li>are there ever two paths?
		<ul>
			<li>e.g. happy path saves and unhappy path discards</li>
		</ul>
		</li>
	</ul>
	</li>
	<li>are there any similarities to exception handling?
	<ul>
		<li>one part of code has problem, another deals with it</li>
	</ul>
	</li>
</ul>


<h3 id="ResourceScopes-Issues">Issues</h3>

<ul>
	<li>Consider threads as well as nesting</li>
	<li>How do scopes interact with io! and stm</li>
	<li>Can we hydrate the fork/join tree where we need it?</li>
	<li>How to prevent mess?
	<ul>
		<li>(when-scope :fails ...) et al are very declarative</li>
		<li>but are setting up non-local effects</li>
		<li>potentially leading to wtf when triggered</li>
		<li>is this the right external API?
		<ul>
			<li>any way to ensure correctness</li>
			<li>will we be beset with requests for order control</li>
		</ul>
		</li>
	</ul>
	</li>
	<li>Is the nearest enclosing scope always the right one?
	<ul>
		<li>what to do if not
		<ul>
			<li>named scopes</li>
			<li>scopes as args</li>
		</ul>
		</li>
	</ul>
	</li>
</ul>


<h3 id="ResourceScopes-Proposal">Proposal</h3>

<ul>
	<li>dynamic binding <code>*scope*</code> holds collection of things needing cleanup</li>
	<li>with-open binds a new <code>*scope*</code>, cleans up <code>*scope*</code> at end</li>
	<li>lib APIs can call a new fn <code>(scope thing)</code> to add a resource to the current bound scope
	<ul>
		<li>throws exception if no scope available</li>
	</ul>
	</li>
	<li>REPL cleans up scope before every loop</li>
	<li>*scope* is an atom, so N &quot;child&quot; threads can add to it
	<ul>
		<li>binding conveyance makes this work</li>
		<li>still up to you to make sure &quot;parent&quot; thread outlives children</li>
	</ul>
	</li>
	<li><a href="http://dev.clojure.org/jira/browse/CLJ-2" class="external-link" rel="nofollow">this patch</a> demonstrates the idea</li>
</ul>


<p>IMO this nails all the use cases and problems above, with a few<br />
caveats that I think can be subsumed into a single example as follows:</p>

<p>Caller A creates a scope. Lib B combines several resources to do some<br />
work for A, some of which will be lazy/incomplete when returning to<br />
A. The challenge is that B wants to clean up some, but not all, of the<br />
scoped things it used. Some possibilities:</p>

<ul>
	<li>You are on your own in this case. Don't use scopes.</li>
	<li>Scopes are more queryable/manipulable to help lib B author, e.g. named scopes.
	<ul>
		<li>complicated!</li>
	</ul>
	</li>
	<li>Scope push: Some way to opt back out of as scope (push me to the enclosing scope).
	<ul>
		<li>complicated and difficult to reason about</li>
	</ul>
	</li>
	<li>Make resources aware of their own cleanup logic, so that B can say &quot;I am done with C but still need D and E&quot;.
	<ul>
		<li>non-starter, pollutes every API in the universe with bookkeeping to propagate cleanup logic.</li>
	</ul>
	</li>
	<li>Leverage close-on-consume
	<ul>
		<li>This is an antipatten today, but a potentially useful optimization with scopes in play</li>
	</ul>
	</li>
	<li>Scope grab
	<ul>
		<li>Give Lib B a way to grab the scope associate with a single resource and clean it up:
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<script type="syntaxhighlighter" class="theme: Confluence; brush: java; gutter: false"><![CDATA[;; scope-grab binds a scope and returns it without cleanup
(let [[c c-scope] (scope-grab (c-making-thing))
       d (d-making-thing)]
  ;; do some work that finishes with c
  (release-scope c-scope)
  ;; continue work
)]]></script>
</div></div></li>
		<li>Easier to compose than named scopes
		<ul>
			<li>C doesn't have to do anything special to be used in this way</li>
			<li>B doesn't have to know anything about C's use of scopes</li>
		</ul>
		</li>
		<li>Easier to componse that scope push
		<ul>
			<li>simple inversion: cleanup what you are done with, instead of enumerating the things still in play</li>
		</ul>
		</li>
	</ul>
	</li>
</ul>


<p>I believe that 95% of the current problems people experience are solved with the simple mechanism proposed here. My preference is to start with &quot;you're on your own&quot; and evolve to &quot;scope grab&quot; if necessary. The latter is an easy, non-breaking extension.</p>

<p>TBD to flesh out this approach</p>

<ul>
	<li>investigate interaction with fork/join
	<ul>
		<li>think this reduces to &quot;make binding conveyance work with fork/join&quot;</li>
	</ul>
	</li>
	<li>new protocol or IFn for bits of cleanup logic placed in a scope
	<ul>
		<li>handling Closeable and IFn in an if statement for now</li>
		<li>code in core happens before protocols are available</li>
	</ul>
	</li>
	<li>verify that change to with-open is non-breaking for existing code
	<ul>
		<li>but note no benefit either, until you start calling (scope ...)</li>
	</ul>
	</li>
</ul>


<p>Scenarios</p>

<ol>
	<li>Creating a resource whose lifetime is bounded to yours: use with-open, as you do today</li>
	<li>Creating a resource that will be passed back to a caller unconsumed: call (scope res)
	<ol>
		<li>caller must have made a scope</li>
		<li>mandatory scope is not a limitation here, it is a sensible requirement</li>
	</ol>
	</li>
	<li>Returning &gt;1 resources from a function with different lifecycles and cleanup rules: not supported
	<ol>
		<li>not going to worry about this without realistic example</li>
	</ol>
	</li>
	<li>Create resources from child threads
	<ol>
		<li>works if thread creation conveys bindings</li>
		<li>you are responsible for waiting on child threads</li>
	</ol>
	</li>
	<li>Consuming one resource, pass another through to caller: put with-open around the one you are consuming
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<script type="syntaxhighlighter" class="theme: Confluence; brush: java; gutter: false"><![CDATA[;; a cleaned up here, b cleaned up by caller
(let [a (with-open [a ...] ...
      b (scope ...)]
  b)]]></script>
</div></div></li>
	<li>Decide on the fly whether to clean up or let parent do it
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<script type="syntaxhighlighter" class="theme: Confluence; brush: java; gutter: false"><![CDATA[;; capture-scope? grab-scope? capture-cleanup?
(let [[a s] (capture-scope (make-a))]
  (if (done? ...)
    (s) ;; cleanup myself
    (scope s) ;; punt
))]]></script>
</div></div></li>
</ol>
    
        </div>

        <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="https://dev.clojure.org/display/design/Resource+Scopes"
    dc:identifier="https://dev.clojure.org/display/design/Resource+Scopes"
    dc:title="Resource Scopes"
    trackback:ping="https://dev.clojure.org/rpc/trackback/458779"/>
</rdf:RDF>
-->

        <script type="text/x-template" title="labels-dialog-div">

    
    <div id="labels-dialog">
        <div class="labels-editor">
            <span class="errorMessage error" id="errorSpan"></span>
            <form method="GET" action="" id="add-labels-form">
                <div id="labelOperationErrorContainer">
                    <span class="error"><span class="errorMessage" id="labelOperationErrorMessage"></span></span>
                </div>
    
                <div class="caption">Enter labels to add to this page:</div>
                <div id="label-input-fields">
                    <input autocomplete="off" id="labelsString" name="labelsString" value="">
                    <input id="add-labels-editor-button" type="submit" class="add-labels" value="Add">
                </div>
                <div id="labelsAutocompleteList" class="aui-dd-parent resize-to-input" style="width: 417px"></div>
                <div id="dialog-label-list">
                    <span id="labels-section-title-none" class="no-labels-message" >
None
</span>
<ul class="label-list">
</ul>
                </div>
                <div id="waitImageAndStatus">
                    <img class="waiting" alt="Please wait" src="/s/en_GB/3047/3/_/images/icons/wait.gif">&nbsp;
                    <span id="labelOperationStatus" class="smalltext"></span>
                </div>
                <div class="labels-tip"></div>
            </form>
        </div>
    </div>
</script>
            
    


<div id="labels-section" class="pageSection group">
    <div class="labels-editor">
        <span id="labels-section-title" class="label-title">Labels:</span>
        <div id="labels-section-content" class="content-column">
            <span id="labels-section-title-none" class="no-labels-message" >
None
</span>
<ul class="label-list">
</ul>

                            <a id="labels-edit" href="#" class="show-labels-editor editor-icon" title="Edit Labels">
                    <span class="icon icon-edit">Edit Labels</span>
                </a>
                    </div>
    </div>
</div>

            
            




            
    







<div id="comments-section" class="pageSection group">
    
            <div class="section-header ">
            <h2 id="comments-section-title" class="section-title">
                <a href="#" class="comments-show-hide comments-showing" name="comments">
                                            17 Comments
                                    </a>
            </h2>
            <a title="Hide/Show Comments" href="#" 
               class="comments-show-hide icon comments-showing icon-section-opened">
                Hide/Show Comments
            </a>
        </div>
    
    
                            <ol class="comment-threads top-level " id="page-comments">
                        <li id="comment-thread-950759" class="comment-thread">
                                <div class="comment  " id="comment-950759">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: stuart.sierra" title="stuart.sierra">                </p>
                <p class="date" title="Dec 28, 2010 08:28">
                    Dec 28, 2010
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~stuart.sierra.html"
                          class="url fn"
                   >Stuart Sierra</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>Thoughts:</p>

<ul>
	<li>Explicitly named scopes are less confusing than nearest-enclosing-scope</li>
	<li>Are agent-send semantics (hold until transaction commits) sufficient for STM support?</li>
</ul>


<p>Sample implementation (updated): <a href="https://github.com/stuartsierra/clojure/blob/scope/src/clj/clojure/scope.clj" class="external-link" rel="nofollow">source</a> and <a href="https://github.com/stuartsierra/clojure/blob/scope/test/clojure/test_clojure/scope.clj" class="external-link" rel="nofollow">tests</a>.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Resource+Scopes-focusedCommentId=950759.html#comment-950759"
                id="comment-permalink-950759"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Resource+Scopes-focusedCommentId=950759.html#comment-950759"
    dc:identifier="Resource+Scopes-focusedCommentId=950759.html#comment-950759"
    dc:title="Resource Scopes"
    trackback:ping="https://dev.clojure.org/rpc/trackback/950759"/>
</rdf:RDF>
-->

                    
                                    <ol class="comment-threads">
                                        <li id="comment-thread-1572922" class="comment-thread">
                                <div class="comment  " id="comment-1572922">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: mikehinchey" title="mikehinchey">                </p>
                <p class="date" title="Jan 28, 2011 01:09">
                    Jan 28, 2011
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="https://dev.clojure.org/display/~mikehinchey"
                          class="url fn"
                   >Mike Hinchey</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>There's a discussion on clojure-dev about with-open related to dropping exceptions.  I suggest each of the handlers in your implementation, and Rich's, should be called in a try/catch so exceptions aren't silently dropped.  There needs to be a decision about what do do in the catch: propagate 1 of the 2 exceptions and handle the other another way or swallow it, or throw a new exception that holds both.  Another key in your scope object could hold a function that throws which the user could override.  Scopes should be consistent with an improved with-open in this regard.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Resource+Scopes-focusedCommentId=1572922.html#comment-1572922"
                id="comment-permalink-1572922"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Resource+Scopes-focusedCommentId=1572922.html#comment-1572922"
    dc:identifier="Resource+Scopes-focusedCommentId=1572922.html#comment-1572922"
    dc:title="Resource Scopes"
    trackback:ping="https://dev.clojure.org/rpc/trackback/1572922"/>
</rdf:RDF>
-->

                    
                                </li>
                                        <li id="comment-thread-1572923" class="comment-thread">
                                <div class="comment  " id="comment-1572923">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: mikehinchey" title="mikehinchey">                </p>
                <p class="date" title="Jan 28, 2011 01:41">
                    Jan 28, 2011
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="https://dev.clojure.org/display/~mikehinchey"
                          class="url fn"
                   >Mike Hinchey</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>Concerning named scopes... I don't see how this would be used across libraries.  Say I write a db library (I have) that opens lots of resources deeply nested (the fns return objects that hold resources).  Does the user use declare-scope and the library takes scope as a param to it's fns?</p>

<p>With enclosing scopes (like Rich's), everyone would refer to the single *scope* var, and if the user wants multiple independent scopes, use binding (not tested):</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<script type="syntaxhighlighter" class="theme: Confluence; brush: java; gutter: false"><![CDATA[(scope
&nbsp;&nbsp;(lib1/acquire-resources)
&nbsp;&nbsp;(let [s1 *scope*]
&nbsp;&nbsp; &nbsp;(scope
&nbsp;&nbsp; &nbsp; &nbsp;(lib2/acquire-files)
&nbsp;&nbsp; &nbsp; &nbsp;(binding [*scope* s1]
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;(lib1/acquire-more)))))]]></script>
</div></div>
<p>In an implementation I did, the enclosing scope style worked nicely, but I also had a macro scope1 that created a scope if there was not already one, otherwise, added nothing so the body could return more resources to the calling scope.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Resource+Scopes-focusedCommentId=1572923.html#comment-1572923"
                id="comment-permalink-1572923"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Resource+Scopes-focusedCommentId=1572923.html#comment-1572923"
    dc:identifier="Resource+Scopes-focusedCommentId=1572923.html#comment-1572923"
    dc:title="Resource Scopes"
    trackback:ping="https://dev.clojure.org/rpc/trackback/1572923"/>
</rdf:RDF>
-->

                    
                                </li>
                                        <li id="comment-thread-8192747" class="comment-thread">
                                <div class="comment  " id="comment-8192747">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: bbloom" title="bbloom">                </p>
                <p class="date" title="Oct 12, 2013 18:14">
                    Oct 12, 2013
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~bbloom.html"
                          class="url fn"
                   >Brandon Bloom</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>(I'm here via <a href="https://groups.google.com/d/topic/clojure/qPUd3AEVxT8/discussion" class="external-link" rel="nofollow">https://groups.google.com/d/topic/clojure/qPUd3AEVxT8/discussion</a>)</p><p>In this code, knowing the name of a scope grants full privileges over the scope. Alternatively, unique scopes could be allocated like gensyms and their protocol could offer a function for creating a handle to the scope with reduced privledges. This would allow you to pass a scope pointer around while retaining authority higher up in the stack. Additionally, &quot;stack&quot; can be generalized to &quot;process tree&quot;, since you're no longer tied to a thread local: You could create a scope and pass the privilege object around to transfer ownership. Although, I guess you can do that by manually fiddling with the vars anyway.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Resource+Scopes-focusedCommentId=8192747.html#comment-8192747"
                id="comment-permalink-8192747"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Resource+Scopes-focusedCommentId=8192747.html#comment-8192747"
    dc:identifier="Resource+Scopes-focusedCommentId=8192747.html#comment-8192747"
    dc:title="Resource Scopes"
    trackback:ping="https://dev.clojure.org/rpc/trackback/8192747"/>
</rdf:RDF>
-->

                    
                                </li>
                                </ol>
                        </li>
                        <li id="comment-thread-950904" class="comment-thread">
                                <div class="comment  " id="comment-950904">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: tim.ewald@thinkrelevance.com" title="tim.ewald@thinkrelevance.com">                </p>
                <p class="date" title="Jan 14, 2011 10:04">
                    Jan 14, 2011
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="https://dev.clojure.org/display/~tim.ewald@thinkrelevance.com"
                          class="url fn"
                   >Tim Ewald</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>I think the goal is to hold precious resources long enough to do required processing -- no more, no less -- then let it go. This problem is not restricted to a particular known Java types or their uses (e.g., accessing a File object via a lazy sequence). It could be any Java type held referred to from anywhere (e.g., a database connection held in a closure tied to an anonymous function). So you have to assume that anything could own a precious resource.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Resource+Scopes-focusedCommentId=950904.html#comment-950904"
                id="comment-permalink-950904"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Resource+Scopes-focusedCommentId=950904.html#comment-950904"
    dc:identifier="Resource+Scopes-focusedCommentId=950904.html#comment-950904"
    dc:title="Resource Scopes"
    trackback:ping="https://dev.clojure.org/rpc/trackback/950904"/>
</rdf:RDF>
-->

                    
                                    <ol class="comment-threads">
                                        <li id="comment-thread-950906" class="comment-thread">
                                <div class="comment  " id="comment-950906">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: richhickey" title="richhickey">                </p>
                <p class="date" title="Jan 14, 2011 10:09">
                    Jan 14, 2011
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~richhickey.html"
                          class="url fn"
                   >Rich Hickey</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>Yes, in all the above files are just an example resource, and 'closing' is a metaphor for releasing it</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Resource+Scopes-focusedCommentId=950906.html#comment-950906"
                id="comment-permalink-950906"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Resource+Scopes-focusedCommentId=950906.html#comment-950906"
    dc:identifier="Resource+Scopes-focusedCommentId=950906.html#comment-950906"
    dc:title="Resource Scopes"
    trackback:ping="https://dev.clojure.org/rpc/trackback/950906"/>
</rdf:RDF>
-->

                    
                                </li>
                                </ol>
                        </li>
                        <li id="comment-thread-950907" class="comment-thread">
                                <div class="comment  " id="comment-950907">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: tim.ewald@thinkrelevance.com" title="tim.ewald@thinkrelevance.com">                </p>
                <p class="date" title="Jan 14, 2011 10:12">
                    Jan 14, 2011
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="https://dev.clojure.org/display/~tim.ewald@thinkrelevance.com"
                          class="url fn"
                   >Tim Ewald</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>Is it necessary to address these two caes the same way:</p>

<ul>
	<li>he who acquires releases</li>
	<li>one acquires, another releases</li>
</ul>


<p>That is, with-open (like using in C# and try in Java 7), is useful in the case that bound resource will be consumed entirely. Returning it wrapped in a lazy seq or any other construct, is a different case. Does it have to work with with-open? Certainly in C#, you use using when you'll consume and dispose the resource and you don't use using in cases where you're storing the resource, handing it back to someone, etc.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Resource+Scopes-focusedCommentId=950907.html#comment-950907"
                id="comment-permalink-950907"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Resource+Scopes-focusedCommentId=950907.html#comment-950907"
    dc:identifier="Resource+Scopes-focusedCommentId=950907.html#comment-950907"
    dc:title="Resource Scopes"
    trackback:ping="https://dev.clojure.org/rpc/trackback/950907"/>
</rdf:RDF>
-->

                    
                                    <ol class="comment-threads">
                                        <li id="comment-thread-950908" class="comment-thread">
                                <div class="comment  " id="comment-950908">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: richhickey" title="richhickey">                </p>
                <p class="date" title="Jan 14, 2011 10:21">
                    Jan 14, 2011
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~richhickey.html"
                          class="url fn"
                   >Rich Hickey</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>No, but the problem we are contending with is when 'he who acquires releases' is insufficient. Also, it can be difficult to know sometimes when someone has captured your resource in a nested contexts and then leaked it out of your with/using. This is much more likely to happen when HOFs and laziness are involved.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Resource+Scopes-focusedCommentId=950908.html#comment-950908"
                id="comment-permalink-950908"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Resource+Scopes-focusedCommentId=950908.html#comment-950908"
    dc:identifier="Resource+Scopes-focusedCommentId=950908.html#comment-950908"
    dc:title="Resource Scopes"
    trackback:ping="https://dev.clojure.org/rpc/trackback/950908"/>
</rdf:RDF>
-->

                    
                                    <ol class="comment-threads">
                                        <li id="comment-thread-950910" class="comment-thread">
                                <div class="comment  " id="comment-950910">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: tim.ewald@thinkrelevance.com" title="tim.ewald@thinkrelevance.com">                </p>
                <p class="date" title="Jan 14, 2011 10:52">
                    Jan 14, 2011
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="https://dev.clojure.org/display/~tim.ewald@thinkrelevance.com"
                          class="url fn"
                   >Tim Ewald</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>Agreed. Certainly we pass references to precious resources managed by a with/using into functions all the time w/o really knowing what might happen to them.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Resource+Scopes-focusedCommentId=950910.html#comment-950910"
                id="comment-permalink-950910"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Resource+Scopes-focusedCommentId=950910.html#comment-950910"
    dc:identifier="Resource+Scopes-focusedCommentId=950910.html#comment-950910"
    dc:title="Resource Scopes"
    trackback:ping="https://dev.clojure.org/rpc/trackback/950910"/>
</rdf:RDF>
-->

                    
                                </li>
                                </ol>
                        </li>
                                </ol>
                        </li>
                        <li id="comment-thread-950909" class="comment-thread">
                                <div class="comment  " id="comment-950909">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: tim.ewald@thinkrelevance.com" title="tim.ewald@thinkrelevance.com">                </p>
                <p class="date" title="Jan 14, 2011 10:54">
                    Jan 14, 2011
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="https://dev.clojure.org/display/~tim.ewald@thinkrelevance.com"
                          class="url fn"
                   >Tim Ewald</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>I think there is a strong relationship to exception handling.</p>

<p>EH allows a callee to trigger a caller's cleanup code, scopes allow a callee to be able to trigger it's own cleanup code<br />
In either case, the caller defines when/where the cleanup happens.</p>

<p>One thing EH has that I haven't seen mentioned beyond the comment about supporting nesting, is the need for some form of propagation. For instance A calls B, B calls C and D. B gets constructs back from both C and D. Both constructs encapsulate references to precious resources. B wants to clean up the resource from C when it's done. B wants to return the construct returned from D back to A. A will clean it up when it's done with it. So:</p>

<ul>
	<li>C and D need a way to indicate &quot;someone else has to clean this up&quot;</li>
	<li>B needs a way to indicate &quot;I clean up the resource from D, but not C&quot;</li>
	<li>A needs a way to indicate &quot;I clean up the resource from C&quot;</li>
</ul>


<p>In the EH case, A and B would indicate what cases they handle by catching a particular type and/or rethrowing. In the resource case, all you have is the construct the callee returned, which may (or may not) encapsulate a resource. If cleanup code were associated with the construct that encapsulates the resource, and there were nested scopes, functions could hand responsibility for cleaning up a resource by &quot;popping scope&quot; for a given construct. That is, B would have a scope, but also a call to say &quot;push responsibility for cleaning up the resource encapsulated by the construct returned from C up to the enclosing scope&quot;.</p>

<p>Hopefully that makes sense - the main point is that it some way to have hierarchy for processing (like EH) is key.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Resource+Scopes-focusedCommentId=950909.html#comment-950909"
                id="comment-permalink-950909"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Resource+Scopes-focusedCommentId=950909.html#comment-950909"
    dc:identifier="Resource+Scopes-focusedCommentId=950909.html#comment-950909"
    dc:title="Resource Scopes"
    trackback:ping="https://dev.clojure.org/rpc/trackback/950909"/>
</rdf:RDF>
-->

                    
                                    <ol class="comment-threads">
                                        <li id="comment-thread-8192748" class="comment-thread">
                                <div class="comment  " id="comment-8192748">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: bbloom" title="bbloom">                </p>
                <p class="date" title="Oct 12, 2013 18:18">
                    Oct 12, 2013
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~bbloom.html"
                          class="url fn"
                   >Brandon Bloom</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p><span>&gt; I think there is a strong relationship to exception handling.</span></p><p>There's also a sound theoretical basis for this relationship too!</p><p>I've found myself linking folks to <a href="http://arxiv.org/abs/1203.1539" class="external-link" rel="nofollow">this paper about Eff</a> more and more frequently.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Resource+Scopes-focusedCommentId=8192748.html#comment-8192748"
                id="comment-permalink-8192748"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Resource+Scopes-focusedCommentId=8192748.html#comment-8192748"
    dc:identifier="Resource+Scopes-focusedCommentId=8192748.html#comment-8192748"
    dc:title="Resource Scopes"
    trackback:ping="https://dev.clojure.org/rpc/trackback/8192748"/>
</rdf:RDF>
-->

                    
                                </li>
                                </ol>
                        </li>
                        <li id="comment-thread-1572924" class="comment-thread">
                                <div class="comment  " id="comment-1572924">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: mikehinchey" title="mikehinchey">                </p>
                <p class="date" title="Jan 28, 2011 01:49">
                    Jan 28, 2011
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="https://dev.clojure.org/display/~mikehinchey"
                          class="url fn"
                   >Mike Hinchey</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>The link under Plan to github is broken because of a trailing paren.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Resource+Scopes-focusedCommentId=1572924.html#comment-1572924"
                id="comment-permalink-1572924"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Resource+Scopes-focusedCommentId=1572924.html#comment-1572924"
    dc:identifier="Resource+Scopes-focusedCommentId=1572924.html#comment-1572924"
    dc:title="Resource Scopes"
    trackback:ping="https://dev.clojure.org/rpc/trackback/1572924"/>
</rdf:RDF>
-->

                    
                                </li>
                        <li id="comment-thread-2424856" class="comment-thread">
                                <div class="comment  " id="comment-2424856">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: stuart.sierra" title="stuart.sierra">                </p>
                <p class="date" title="Jul 04, 2011 11:38">
                    Jul 04, 2011
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~stuart.sierra.html"
                          class="url fn"
                   >Stuart Sierra</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>&quot;Scope grab&quot; is an interesting addition. Earlier on in these discussions, I was afraid that having only one scope active at a time would be too limiting. But now I'm not so sure. How often does one need to keep two or more resources open at the same time and close them at <em>different</em> times? I expect not often, so &quot;you're on your own&quot; is an acceptable answer.</p>

<p>This still requires that users be cognizant of how they are consuming lazy sequences, and that libraries which create resources (e.g. DBs, files, sockets) to be redesigned to support scopes.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Resource+Scopes-focusedCommentId=2424856.html#comment-2424856"
                id="comment-permalink-2424856"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Resource+Scopes-focusedCommentId=2424856.html#comment-2424856"
    dc:identifier="Resource+Scopes-focusedCommentId=2424856.html#comment-2424856"
    dc:title="Resource Scopes"
    trackback:ping="https://dev.clojure.org/rpc/trackback/2424856"/>
</rdf:RDF>
-->

                    
                                    <ol class="comment-threads">
                                        <li id="comment-thread-2424857" class="comment-thread">
                                <div class="comment  " id="comment-2424857">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: stu" title="stu">                </p>
                <p class="date" title="Jul 05, 2011 07:51">
                    Jul 05, 2011
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~stu.html"
                          class="url fn"
                   >Stuart Halloway</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>Users will have to be cognizant in the same way they have to be cognizant of transactions when using the STM: if you do it wrong you will get an exception.</p>

<p>Libraries won't be required to change, i.e. old code isn't broken. They will have to change to take advantage of the feature, but I think that is inevitable. A big goal for me is to keep the means of combination clean, e.g. the sequence library doesn't have to change, only some input sources to it.</p>

<p>I hope to post some examples later this week. If you have specific examples you would like to see let me know.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Resource+Scopes-focusedCommentId=2424857.html#comment-2424857"
                id="comment-permalink-2424857"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Resource+Scopes-focusedCommentId=2424857.html#comment-2424857"
    dc:identifier="Resource+Scopes-focusedCommentId=2424857.html#comment-2424857"
    dc:title="Resource Scopes"
    trackback:ping="https://dev.clojure.org/rpc/trackback/2424857"/>
</rdf:RDF>
-->

                    
                                </li>
                                </ol>
                        </li>
                        <li id="comment-thread-2424863" class="comment-thread">
                                <div class="comment  " id="comment-2424863">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: tim.ewald@thinkrelevance.com" title="tim.ewald@thinkrelevance.com">                </p>
                <p class="date" title="Jul 05, 2011 13:50">
                    Jul 05, 2011
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="https://dev.clojure.org/display/~tim.ewald@thinkrelevance.com"
                          class="url fn"
                   >Tim Ewald</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>It doesn't feel complete to me (but last time we talked about something more complete, a bunch of people in the room weren't even sure there was a problem, so what do I know... :-).</p>

<p>It isn't clear in your proposal whether scopes nest or not. If not, what happens when a library attempts to make a scope when one already exists? Does it make a new one, reuse the old one, throw an exception, or do something else?</p>

<p>This doesn't feel any simpler to reason about that scope push, but I agree it is essentially an inversion of that idea.</p>

<p>In any case - this, scope push, or reifying a close protocol onto things - you have to chain cleanup calls if you encapsulate things AND want (or require in the close protocol case) a caller to be able to selectively control when somethings get closed.</p>

<p>I'd like to work through a complex example with you when you have time.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Resource+Scopes-focusedCommentId=2424863.html#comment-2424863"
                id="comment-permalink-2424863"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Resource+Scopes-focusedCommentId=2424863.html#comment-2424863"
    dc:identifier="Resource+Scopes-focusedCommentId=2424863.html#comment-2424863"
    dc:title="Resource Scopes"
    trackback:ping="https://dev.clojure.org/rpc/trackback/2424863"/>
</rdf:RDF>
-->

                    
                                    <ol class="comment-threads">
                                        <li id="comment-thread-2424895" class="comment-thread">
                                <div class="comment  " id="comment-2424895">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: stu" title="stu">                </p>
                <p class="date" title="Jul 12, 2011 07:20">
                    Jul 12, 2011
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~stu.html"
                          class="url fn"
                   >Stuart Halloway</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>Scopes nest, e.g. with-open will make a new one. Most &quot;selective close&quot; scenarios are not supported. I am going to add some examples</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Resource+Scopes-focusedCommentId=2424895.html#comment-2424895"
                id="comment-permalink-2424895"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Resource+Scopes-focusedCommentId=2424895.html#comment-2424895"
    dc:identifier="Resource+Scopes-focusedCommentId=2424895.html#comment-2424895"
    dc:title="Resource Scopes"
    trackback:ping="https://dev.clojure.org/rpc/trackback/2424895"/>
</rdf:RDF>
-->

                    
                                </li>
                                </ol>
                        </li>
                        <li id="comment-thread-4063343" class="comment-thread">
                                <div class="comment  " id="comment-4063343">
                <p class="comment-user-logo">
                    <img class="userLogo logo anonymous" src="../../s/en_GB/3047/3/_/images/icons/profilepics/anonymous.png"
           alt="User icon: steveminer@gmail.com" title="steveminer@gmail.com">                </p>
                <p class="date" title="Nov 21, 2011 15:50">
                    Nov 21, 2011
                </p>
                <div class="comment-header">
                    <h4 class="author"><a href="../../login.action-os_destination=-display-~steveminer@gmail.com.html"
                          class="url fn"
                   >Steve Miner</a></h4>
                </div>
                <div class="comment-body">
                    <div class="comment-content wiki-content">
                        <p>At the Clojure/conj, Rich Hickey said that this was still an open problem.  It turns out that it's difficult to know what the user code had done with a resource so it's not clear that there's a general solution.</p>
                    </div>
                    <div class="comment-actions">
                                                      <ul class="comment-actions-secondary">
                                                          <li class="first comment-permalink">
            <a title="Permanent link to this comment" href="Resource+Scopes-focusedCommentId=4063343.html#comment-4063343"
                id="comment-permalink-4063343"                ><span>Permalink</span></a></li>
            </ul>
                                <ul class="comment-actions-primary">
            </ul>
                      </div>
                </div>
            </div>

            <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="Resource+Scopes-focusedCommentId=4063343.html#comment-4063343"
    dc:identifier="Resource+Scopes-focusedCommentId=4063343.html#comment-4063343"
    dc:title="Resource Scopes"
    trackback:ping="https://dev.clojure.org/rpc/trackback/4063343"/>
</rdf:RDF>
-->

                    
                                </li>
                </ol>
    
    </div>


            
</div>


    



    
    

    
    
    


    



    <br class="clear">
</div>
  
    </div>
</div>

<div id="footer">
                                                <p class="license license-opensource">
                  Powered by a free <b>Atlassian Confluence Open Source Project License</b> granted to Clojure. <a href="http://www.atlassian.com/c/conf/11461">Evaluate Confluence today</a>.<br>
                </p>
                        
    <ul id="poweredby">
        <li class="noprint">Powered by <a href="http://www.atlassian.com/software/confluence" class="hover-footer-link">Atlassian Confluence</a> <span id='footer-build-information'>4.0</span>, the <a href="http://www.atlassian.com/software/confluence/tour/enterprise-wiki.jsp" class="hover-footer-link">Enterprise Wiki</a></li>
        <li class="print-only">Printed by Atlassian Confluence 4.0, the Enterprise Wiki.</li>        
        <li class="noprint"> &nbsp; |&nbsp; <a href="http://jira.atlassian.com/secure/BrowseProject.jspa?id=10470" class="hover-footer-link">Report a bug</a></li>
        <li class="noprint"> &nbsp;|&nbsp; <a href="http://www.atlassian.com/about/connected.jsp?s_kwcid=Confluence-stayintouch" class="hover-footer-link">Atlassian News</a></li>
    </ul>

    

            <div><span style="">Site support by</span><a href="http://contegix.com"> <img style="vertical-align:middle" src="../../download/attachments/459015/contegix.jpg.html"/></a></div>
    </div></div>
</body>
</html>
